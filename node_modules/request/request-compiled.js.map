{"version":3,"sources":["request.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,OAAO,QAAQ,MAAR,CAAX;IACI,QAAQ,QAAQ,OAAR,CADZ;IAEI,MAAM,QAAQ,KAAR,CAFV;IAGI,OAAO,QAAQ,MAAR,CAHX;IAII,SAAS,QAAQ,QAAR,CAJb;IAKI,OAAO,QAAQ,MAAR,CALX;IAMI,OAAO,QAAQ,MAAR,CANX;IAOI,OAAO,QAAQ,WAAR,CAPX;IAQI,OAAO,QAAQ,MAAR,CARX;IASI,gBAAgB,QAAQ,gBAAR,CATpB;IAUI,OAAO,QAAQ,YAAR,CAVX;IAWI,eAAe,QAAQ,cAAR,CAXnB;IAYI,WAAW,QAAQ,UAAR,CAZf;IAaI,eAAe,QAAQ,eAAR,CAbnB;IAcI,WAAW,QAAQ,WAAR,CAdf;IAeI,SAAS,QAAQ,QAAR,CAfb;IAgBI,WAAW,QAAQ,UAAR,CAhBf;IAiBI,eAAe,QAAQ,eAAR,EAAyB,MAjB5C;IAkBI,UAAU,QAAQ,eAAR,CAlBd;IAmBI,UAAU,QAAQ,eAAR,CAnBd;IAoBI,kBAAkB,QAAQ,uBAAR,CApBtB;IAqBI,cAAc,QAAQ,mBAAR,EAA6B,WArB/C;IAsBI,MAAM,QAAQ,WAAR,EAAqB,GAtB/B;IAuBI,OAAO,QAAQ,YAAR,EAAsB,IAvBjC;IAwBI,QAAQ,QAAQ,aAAR,EAAuB,KAxBnC;IAyBI,YAAY,QAAQ,iBAAR,EAA2B,SAzB3C;IA0BI,WAAW,QAAQ,gBAAR,EAA0B,QA1BzC;IA2BI,SAAS,QAAQ,cAAR,EAAwB,MA3BrC;;AA6BA,IAAI,gBAAgB,QAAQ,aAA5B;IACI,eAAe,QAAQ,YAD3B;IAEI,WAAW,QAAQ,QAFvB;IAGI,QAAQ,QAAQ,KAHpB;IAII,OAAO,QAAQ,IAJnB;IAKI,UAAU,QAAQ,OALtB;IAMI,kBAAkB,QAAQ,GAAR,EANtB;;AASA,IAAI,aAAa,EAAjB;;AAEA,SAAS,oBAAT,CAA8B,QAA9B,EAAwC,OAAxC,EAAiD;;;;AAI/C,MAAI,SAAS,EAAb;AACA,OAAK,IAAI,CAAT,IAAc,OAAd,EAAuB;AACrB,QAAI,cAAe,SAAS,OAAT,CAAiB,CAAjB,MAAwB,CAAC,CAA5C;AACA,QAAI,WAAJ,EAAiB;AACf,aAAO,CAAP,IAAY,QAAQ,CAAR,CAAZ;AACD;AACF;AACD,SAAO,MAAP;AACD;;AAED,SAAS,0BAAT,CAAoC,QAApC,EAA8C,OAA9C,EAAuD;;;;AAIrD,MAAI,SAAS,EAAb;AACA,OAAK,IAAI,CAAT,IAAc,OAAd,EAAuB;AACrB,QAAI,aAAa,EAAE,SAAS,OAAT,CAAiB,CAAjB,MAAwB,CAAC,CAA3B,CAAjB;AACA,QAAI,aAAc,OAAO,QAAQ,CAAR,CAAP,KAAsB,UAAxC;AACA,QAAI,EAAE,cAAc,UAAhB,CAAJ,EAAiC;AAC/B,aAAO,CAAP,IAAY,QAAQ,CAAR,CAAZ;AACD;AACF;AACD,SAAO,MAAP;AAED;;;AAGD,SAAS,aAAT,GAAyB;AACvB,MAAI,OAAO,IAAX;AACA,SAAO;AACL,SAAK,KAAK,GADL;AAEL,YAAQ,KAAK,MAFR;AAGL,aAAS,KAAK;AAHT,GAAP;AAKD;;;AAGD,SAAS,cAAT,GAA0B;AACxB,MAAI,OAAO,IAAX;AACA,SAAO;AACL,gBAAY,KAAK,UADZ;AAEL,UAAM,KAAK,IAFN;AAGL,aAAS,KAAK,OAHT;AAIL,aAAS,cAAc,IAAd,CAAmB,KAAK,OAAxB;AAJJ,GAAP;AAMD;;AAED,SAAS,OAAT,CAAkB,OAAlB,EAA2B;;;;;;;;AAQzB,MAAI,OAAO,IAAX;;;AAGA,MAAI,QAAQ,GAAZ,EAAiB;AACf,SAAK,IAAL,GAAY,IAAI,GAAJ,CAAQ,IAAR,CAAZ;AACA,cAAU,KAAK,IAAL,CAAU,OAAV,CAAkB,OAAlB,CAAV;AACD;;AAED,SAAO,MAAP,CAAc,IAAd,CAAmB,IAAnB;AACA,MAAI,WAAW,OAAO,IAAP,CAAY,QAAQ,SAApB,CAAf;AACA,MAAI,cAAc,qBAAqB,QAArB,EAA+B,OAA/B,CAAlB;;AAEA,SAAO,IAAP,EAAa,WAAb;AACA,YAAU,2BAA2B,QAA3B,EAAqC,OAArC,CAAV;;AAEA,OAAK,QAAL,GAAgB,IAAhB;AACA,OAAK,QAAL,GAAgB,IAAhB;AACA,MAAI,QAAQ,MAAZ,EAAoB;AAClB,SAAK,cAAL,GAAsB,IAAtB;AACD;AACD,OAAK,GAAL,GAAW,IAAI,WAAJ,CAAgB,IAAhB,CAAX;AACA,OAAK,KAAL,GAAa,IAAI,IAAJ,CAAS,IAAT,CAAb;AACA,OAAK,MAAL,GAAc,IAAI,KAAJ,CAAU,IAAV,CAAd;AACA,OAAK,UAAL,GAAkB,IAAI,SAAJ,CAAc,IAAd,CAAlB;AACA,OAAK,SAAL,GAAiB,IAAI,QAAJ,CAAa,IAAb,CAAjB;AACA,OAAK,OAAL,GAAe,IAAI,MAAJ,CAAW,IAAX,CAAf;AACA,OAAK,IAAL,CAAU,OAAV;AACD;;AAED,KAAK,QAAL,CAAc,OAAd,EAAuB,OAAO,MAA9B;;;AAGA,QAAQ,KAAR,GAAgB,QAAQ,GAAR,CAAY,UAAZ,IAA0B,cAAc,IAAd,CAAmB,QAAQ,GAAR,CAAY,UAA/B,CAA1C;AACA,SAAS,KAAT,GAAiB;AACf,MAAI,QAAQ,KAAZ,EAAmB;AACjB,YAAQ,KAAR,CAAc,YAAd,EAA4B,KAAK,MAAL,CAAY,KAAZ,CAAkB,IAAlB,EAAwB,SAAxB,CAA5B;AACD;AACF;AACD,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,KAA1B;;AAEA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,OAAV,EAAmB;;;;AAI1C,MAAI,OAAO,IAAX;AACA,MAAI,CAAC,OAAL,EAAc;AACZ,cAAU,EAAV;AACD;AACD,OAAK,OAAL,GAAe,KAAK,OAAL,GAAe,KAAK,KAAK,OAAV,CAAf,GAAoC,EAAnD;;;;AAIA,OAAK,IAAI,UAAT,IAAuB,KAAK,OAA5B,EAAqC;AACnC,QAAI,OAAO,KAAK,OAAL,CAAa,UAAb,CAAP,KAAoC,WAAxC,EAAqD;AACnD,aAAO,KAAK,OAAL,CAAa,UAAb,CAAP;AACD;AACF;;AAED,WAAS,OAAT,CAAiB,IAAjB,EAAuB,KAAK,OAA5B;;AAEA,MAAI,CAAC,KAAK,MAAV,EAAkB;AAChB,SAAK,MAAL,GAAc,QAAQ,MAAR,IAAkB,KAAhC;AACD;AACD,MAAI,CAAC,KAAK,YAAV,EAAwB;AACtB,SAAK,YAAL,GAAoB,QAAQ,YAA5B;AACD;;AAED,OAAK,GAAL,CAAS,IAAT,CAAc,OAAd;;AAEA,QAAM,OAAN;AACA,MAAI,CAAC,KAAK,IAAN,IAAc,KAAK,IAAL,KAAc,KAAhC,EAAuC;AACrC,SAAK,IAAL,GAAY,UAAZ;AACD;AACD,OAAK,KAAL,GAAa,KAAK,KAAL,IAAc,EAA3B;AACA,OAAK,kBAAL,GAA0B,IAA1B;;;AAGA,MAAI,CAAC,KAAK,SAAN,IAAmB,KAAK,QAA5B,EAAsC;AACpC,SAAK,SAAL,GAAiB,KAAK,QAAtB;AACA,SAAK,QAAL,GAAgB,YAAY;AAC1B,UAAI,KAAK,eAAT,EAA0B;AACxB,e;AACD;AACD,WAAK,eAAL,GAAuB,IAAvB;AACA,WAAK,SAAL,CAAe,KAAf,CAAqB,IAArB,EAA2B,SAA3B;AACD,KAND;AAOA,SAAK,EAAL,CAAQ,OAAR,EAAiB,KAAK,QAAL,CAAc,IAAd,EAAjB;AACA,SAAK,EAAL,CAAQ,UAAR,EAAoB,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,EAAyB,IAAzB,CAApB;AACD;;;AAGD,MAAI,CAAC,KAAK,GAAN,IAAa,KAAK,GAAtB,EAA2B;AACzB,SAAK,GAAL,GAAW,KAAK,GAAhB;AACA,WAAO,KAAK,GAAZ;AACD;;;;AAID,MAAI,KAAK,OAAT,EAAkB;AAChB,QAAI,OAAO,KAAK,OAAZ,KAAwB,QAA5B,EAAsC;AACpC,aAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,kCAAV,CAAnB,CAAP;AACD;;AAED,QAAI,OAAO,KAAK,GAAZ,KAAoB,QAAxB,EAAkC;AAChC,aAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,yDAAV,CAAnB,CAAP;AACD;;AAED,QAAI,KAAK,GAAL,CAAS,OAAT,CAAiB,IAAjB,MAA2B,CAA3B,IAAgC,KAAK,GAAL,CAAS,OAAT,CAAiB,KAAjB,MAA4B,CAAC,CAAjE,EAAoE;AAClE,aAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,uDAAV,CAAnB,CAAP;AACD;;;;AAID,QAAI,uBAAuB,KAAK,OAAL,CAAa,WAAb,CAAyB,GAAzB,MAAkC,KAAK,OAAL,CAAa,MAAb,GAAsB,CAAnF;AACA,QAAI,qBAAqB,KAAK,GAAL,CAAS,OAAT,CAAiB,GAAjB,MAA0B,CAAnD;;AAEA,QAAI,wBAAwB,kBAA5B,EAAgD;AAC9C,WAAK,GAAL,GAAW,KAAK,OAAL,GAAe,KAAK,GAAL,CAAS,KAAT,CAAe,CAAf,CAA1B;AACD,KAFD,MAEO,IAAI,wBAAwB,kBAA5B,EAAgD;AACrD,WAAK,GAAL,GAAW,KAAK,OAAL,GAAe,KAAK,GAA/B;AACD,KAFM,MAEA,IAAI,KAAK,GAAL,KAAa,EAAjB,EAAqB;AAC1B,WAAK,GAAL,GAAW,KAAK,OAAhB;AACD,KAFM,MAEA;AACL,WAAK,GAAL,GAAW,KAAK,OAAL,GAAe,GAAf,GAAqB,KAAK,GAArC;AACD;AACD,WAAO,KAAK,OAAZ;AACD;;;AAGD,MAAI,CAAC,KAAK,GAAV,EAAe;AACb,WAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,oCAAV,CAAnB,CAAP;AACD;;;AAGD,MAAI,OAAO,KAAK,GAAZ,KAAoB,QAAxB,EAAkC;AAChC,SAAK,GAAL,GAAW,IAAI,KAAJ,CAAU,KAAK,GAAf,CAAX;AACD;;;AAGD,MAAI,CAAC,KAAK,GAAL,CAAS,IAAd,EAAoB;AAClB,SAAK,GAAL,CAAS,IAAT,GAAgB,IAAI,MAAJ,CAAW,KAAK,GAAhB,CAAhB;AACD;;;AAGD,MAAI,KAAK,GAAL,CAAS,QAAT,KAAsB,OAA1B,EAAmC;AACjC,WAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,8FAAV,CAAnB,CAAP;AACD;;;AAGD,MAAI,KAAK,GAAL,CAAS,IAAT,KAAkB,MAAtB,EAA8B;AAC5B,SAAK,gBAAL;AACD;;AAED,MAAI,KAAK,SAAL,KAAmB,KAAvB,EAA8B;AAC5B,SAAK,kBAAL,GAA0B,KAA1B;AACD;;AAED,MAAI,CAAC,KAAK,GAAL,CAAS,QAAd,EAAwB;AAAC,SAAK,GAAL,CAAS,QAAT,GAAoB,GAApB;AAAwB;;AAEjD,MAAI,EAAE,KAAK,GAAL,CAAS,IAAT,IAAkB,KAAK,GAAL,CAAS,QAAT,IAAqB,KAAK,GAAL,CAAS,IAAlD,KAA4D,CAAC,KAAK,GAAL,CAAS,MAA1E,EAAkF;;;AAGhF,QAAI,YAAY,IAAI,MAAJ,CAAW,KAAK,GAAhB,CAAhB;AACA,QAAI,UAAU,kBAAkB,SAAlB,GAA8B,GAA5C;AACA,QAAI,OAAO,IAAP,CAAY,OAAZ,EAAqB,MAArB,KAAgC,CAApC,EAAuC;;;;AAIrC,iBAAW,+CAAX;AACD;;AAED,SAAK,KAAL;AACA,WAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,OAAV,CAAnB,CAAP;AACD;;AAED,MAAI,CAAC,KAAK,cAAL,CAAoB,OAApB,CAAL,EAAmC;AACjC,SAAK,KAAL,GAAa,gBAAgB,KAAK,GAArB,CAAb;AACD;;AAED,OAAK,MAAL,GAAc,KAAK,OAAL,CAAa,SAAb,EAAd;AACA,MAAI,KAAK,KAAT,EAAgB;AACd,SAAK,OAAL,CAAa,KAAb,CAAmB,OAAnB;AACD;;AAED,OAAK,SAAL,CAAe,SAAf,CAAyB,OAAzB;;AAEA,OAAK,OAAL,GAAe,KAAf;AACA,MAAI,CAAC,KAAK,SAAL,CAAe,MAAf,CAAL,EAA6B;AAC3B,QAAI,iBAAiB,KAAK,sBAAL,IAA+B,MAApD;AACA,SAAK,SAAL,CAAe,cAAf,EAA+B,KAAK,GAAL,CAAS,QAAxC;AACA,QAAI,KAAK,GAAL,CAAS,IAAb,EAAmB;AACjB,UAAK,EAAE,KAAK,GAAL,CAAS,IAAT,KAAkB,EAAlB,IAAwB,KAAK,GAAL,CAAS,QAAT,KAAsB,OAAhD,KACA,EAAE,KAAK,GAAL,CAAS,IAAT,KAAkB,GAAlB,IAAyB,KAAK,GAAL,CAAS,QAAT,KAAsB,QAAjD,CADL,EACkE;AAChE,aAAK,SAAL,CAAe,cAAf,EAA+B,KAAK,SAAL,CAAe,MAAf,KAA0B,MAAM,KAAK,GAAL,CAAS,IAAzC,CAA/B;AACD;AACF;AACD,SAAK,OAAL,GAAe,IAAf;AACD;;AAED,OAAK,GAAL,CAAS,KAAK,IAAL,IAAa,QAAQ,GAA9B;;AAEA,MAAI,CAAC,KAAK,GAAL,CAAS,IAAd,EAAoB;AAClB,QAAI,KAAK,GAAL,CAAS,QAAT,KAAsB,OAA1B,EAAmC;AAAC,WAAK,GAAL,CAAS,IAAT,GAAgB,EAAhB;AAAmB,KAAvD,MACK,IAAI,KAAK,GAAL,CAAS,QAAT,KAAsB,QAA1B,EAAoC;AAAC,WAAK,GAAL,CAAS,IAAT,GAAgB,GAAhB;AAAoB;AAC/D;;AAED,MAAI,KAAK,KAAL,IAAc,CAAC,KAAK,MAAxB,EAAgC;AAC9B,SAAK,IAAL,GAAY,KAAK,KAAL,CAAW,IAAvB;AACA,SAAK,IAAL,GAAY,KAAK,KAAL,CAAW,QAAvB;AACD,GAHD,MAGO;AACL,SAAK,IAAL,GAAY,KAAK,GAAL,CAAS,IAArB;AACA,SAAK,IAAL,GAAY,KAAK,GAAL,CAAS,QAArB;AACD;;AAED,MAAI,QAAQ,IAAZ,EAAkB;AAChB,SAAK,IAAL,CAAU,QAAQ,IAAlB;AACD;;AAED,MAAI,QAAQ,QAAZ,EAAsB;AACpB,QAAI,WAAW,QAAQ,QAAvB;AACA,QAAI,cAAc,KAAK,IAAL,EAAlB;AACA,QAAI,kBAAkB,UAAU,GAAV,EAAe,KAAf,EAAsB;AAC1C,UAAI,SAAS,MAAM,cAAN,CAAqB,OAArB,CAAT,IAA0C,MAAM,cAAN,CAAqB,SAArB,CAA9C,EAA+E;AAC7E,oBAAY,MAAZ,CAAmB,GAAnB,EAAwB,MAAM,KAA9B,EAAqC,MAAM,OAA3C;AACD,OAFD,MAEO;AACL,oBAAY,MAAZ,CAAmB,GAAnB,EAAwB,KAAxB;AACD;AACF,KAND;AAOA,SAAK,IAAI,OAAT,IAAoB,QAApB,EAA8B;AAC5B,UAAI,SAAS,cAAT,CAAwB,OAAxB,CAAJ,EAAsC;AACpC,YAAI,YAAY,SAAS,OAAT,CAAhB;AACA,YAAI,qBAAqB,KAAzB,EAAgC;AAC9B,eAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,UAAU,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,4BAAgB,OAAhB,EAAyB,UAAU,CAAV,CAAzB;AACD;AACF,SAJD,MAIO;AACL,0BAAgB,OAAhB,EAAyB,SAAzB;AACD;AACF;AACF;AACF;;AAED,MAAI,QAAQ,EAAZ,EAAgB;AACd,SAAK,EAAL,CAAQ,QAAQ,EAAhB;AACD;;AAED,MAAI,KAAK,GAAL,CAAS,IAAb,EAAmB;AACjB,SAAK,IAAL,GAAY,KAAK,GAAL,CAAS,IAArB;AACD,GAFD,MAEO;AACL,SAAK,IAAL,GAAY,KAAK,GAAL,CAAS,QAAT,IAAqB,KAAK,GAAL,CAAS,MAAT,IAAmB,EAAxC,CAAZ;AACD;;AAED,MAAI,KAAK,IAAL,CAAU,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,SAAK,IAAL,GAAY,GAAZ;AACD;;;AAGD,MAAI,QAAQ,GAAZ,EAAiB;AACf,SAAK,GAAL,CAAS,QAAQ,GAAjB;AACD;;AAED,MAAI,QAAQ,IAAZ,EAAkB;AAChB,SAAK,IAAL,CAAU,QAAQ,IAAlB;AACD;;AAED,MAAI,QAAQ,aAAZ,EAA2B;AACzB,SAAK,aAAL,CAAmB,QAAQ,aAA3B;AACD;;AAED,MAAI,QAAQ,IAAZ,EAAkB;AAChB,QAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,QAAQ,IAA7C,EAAmD,UAAnD,CAAJ,EAAoE;AAClE,cAAQ,IAAR,CAAa,IAAb,GAAoB,QAAQ,IAAR,CAAa,QAAjC;AACD;AACD,QAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,QAAQ,IAA7C,EAAmD,UAAnD,CAAJ,EAAoE;AAClE,cAAQ,IAAR,CAAa,IAAb,GAAoB,QAAQ,IAAR,CAAa,QAAjC;AACD;;AAED,SAAK,IAAL,CACE,QAAQ,IAAR,CAAa,IADf,EAEE,QAAQ,IAAR,CAAa,IAFf,EAGE,QAAQ,IAAR,CAAa,eAHf,EAIE,QAAQ,IAAR,CAAa,MAJf;AAMD;;AAED,MAAI,KAAK,IAAL,IAAa,CAAC,KAAK,SAAL,CAAe,iBAAf,CAAlB,EAAqD;AACnD,SAAK,SAAL,CAAe,iBAAf,EAAkC,eAAlC;AACD;;AAED,MAAI,KAAK,GAAL,CAAS,IAAT,IAAiB,CAAC,KAAK,SAAL,CAAe,eAAf,CAAtB,EAAuD;AACrD,QAAI,gBAAgB,KAAK,GAAL,CAAS,IAAT,CAAc,KAAd,CAAoB,GAApB,EAAyB,GAAzB,CAA6B,UAAS,IAAT,EAAe;AAAC,aAAO,KAAK,GAAL,CAAS,QAAT,CAAkB,IAAlB,CAAP;AAA+B,KAA5E,CAApB;AACA,SAAK,IAAL,CAAU,cAAc,CAAd,CAAV,EAA4B,cAAc,KAAd,CAAoB,CAApB,EAAuB,IAAvB,CAA4B,GAA5B,CAA5B,EAA8D,IAA9D;AACD;;AAED,MAAI,CAAC,KAAK,MAAN,IAAgB,KAAK,KAArB,IAA8B,KAAK,KAAL,CAAW,IAAzC,IAAiD,CAAC,KAAK,SAAL,CAAe,qBAAf,CAAtD,EAA6F;AAC3F,QAAI,kBAAkB,KAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,GAAtB,EAA2B,GAA3B,CAA+B,UAAS,IAAT,EAAe;AAAC,aAAO,KAAK,GAAL,CAAS,QAAT,CAAkB,IAAlB,CAAP;AAA+B,KAA9E,CAAtB;AACA,QAAI,aAAa,WAAW,SAAS,gBAAgB,IAAhB,CAAqB,GAArB,CAAT,CAA5B;AACA,SAAK,SAAL,CAAe,qBAAf,EAAsC,UAAtC;AACD;;AAED,MAAI,KAAK,KAAL,IAAc,CAAC,KAAK,MAAxB,EAAgC;AAC9B,SAAK,IAAL,GAAa,KAAK,GAAL,CAAS,QAAT,GAAoB,IAApB,GAA2B,KAAK,GAAL,CAAS,IAApC,GAA2C,KAAK,IAA7D;AACD;;AAED,MAAI,QAAQ,IAAZ,EAAkB;AAChB,SAAK,IAAL,CAAU,QAAQ,IAAlB;AACD;AACD,MAAI,QAAQ,SAAZ,EAAuB;AACrB,SAAK,SAAL,CAAe,QAAQ,SAAvB;AACD;;AAED,MAAI,QAAQ,IAAZ,EAAkB;AAChB,SAAK,MAAL,GAAc,IAAd;AACA,SAAK,WAAL,GAAmB,KAAK,WAAL,IAAoB,CAAvC;AACD;;AAED,WAAS,gBAAT,GAA6B;AAC3B,QAAI,aAAa,KAAK,IAAlB,CAAJ,EAA6B;AAC3B,WAAK,IAAL,GAAY,IAAI,MAAJ,CAAW,KAAK,IAAhB,CAAZ;AACD;;AAED,QAAI,CAAC,KAAK,SAAL,CAAe,gBAAf,CAAL,EAAuC;AACrC,UAAI,MAAJ;AACA,UAAI,OAAO,KAAK,IAAZ,KAAqB,QAAzB,EAAmC;AACjC,iBAAS,OAAO,UAAP,CAAkB,KAAK,IAAvB,CAAT;AACD,OAFD,MAGK,IAAI,MAAM,OAAN,CAAc,KAAK,IAAnB,CAAJ,EAA8B;AACjC,iBAAS,KAAK,IAAL,CAAU,MAAV,CAAiB,UAAU,CAAV,EAAa,CAAb,EAAgB;AAAC,iBAAO,IAAI,EAAE,MAAb;AAAoB,SAAtD,EAAwD,CAAxD,CAAT;AACD,OAFI,MAGA;AACH,iBAAS,KAAK,IAAL,CAAU,MAAnB;AACD;;AAED,UAAI,MAAJ,EAAY;AACV,aAAK,SAAL,CAAe,gBAAf,EAAiC,MAAjC;AACD,OAFD,MAEO;AACL,aAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,+BAAV,CAAnB;AACD;AACF;AACF;AACD,MAAI,KAAK,IAAL,IAAa,CAAC,SAAS,KAAK,IAAd,CAAlB,EAAuC;AACrC;AACD;;AAED,MAAI,QAAQ,KAAZ,EAAmB;AACjB,SAAK,KAAL,CAAW,QAAQ,KAAnB;AACD,GAFD,MAEO,IAAI,KAAK,MAAL,CAAY,MAAZ,IAAsB,KAAK,SAAL,CAAe,eAAf,CAA1B,EAA2D;AAChE,SAAK,KAAL,CAAW,KAAK,MAAL,CAAY,MAAvB;AACD;;AAED,MAAI,WAAW,KAAK,KAAL,IAAc,CAAC,KAAK,MAApB,GAA6B,KAAK,KAAL,CAAW,QAAxC,GAAmD,KAAK,GAAL,CAAS,QAA3E;MACI,iBAAiB,EAAC,SAAQ,IAAT,EAAe,UAAS,KAAxB,EADrB;MAEI,cAAc,KAAK,WAAL,IAAoB,EAFtC;;AAIA,OAAK,UAAL,GAAkB,YAAY,QAAZ,KAAyB,eAAe,QAAf,CAA3C;;AAEA,MAAI,CAAC,KAAK,UAAV,EAAsB;AACpB,WAAO,KAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,uBAAuB,QAAjC,CAAnB,CAAP;AACD;;AAED,MAAI,QAAQ,EAAZ,EAAgB;AACd,SAAK,EAAL,GAAU,QAAQ,EAAlB;AACD;;AAED,MAAI,CAAC,KAAK,KAAV,EAAiB;AACf,QAAI,QAAQ,YAAZ,EAA0B;AACxB,WAAK,YAAL,GAAoB,QAAQ,YAA5B;AACD;;AAED,QAAI,QAAQ,UAAZ,EAAwB;AACtB,WAAK,UAAL,GAAkB,QAAQ,UAA1B;AACD,KAFD,MAEO,IAAI,QAAQ,OAAZ,EAAqB;AAC1B,UAAI,IAAI,SAAR;;AAEA,UAAI,EAAE,KAAF,KAAY,CAAZ,IAAiB,EAAE,KAAF,IAAW,EAAhC,EAAoC;AAClC,aAAK,UAAL,GAAkB,aAAa,OAAb,GAAuB,YAAvB,GAAsC,aAAa,GAArE;AACD,OAFD,MAEO;AACL,aAAK,UAAL,GAAkB,KAAK,UAAL,CAAgB,KAAlC;AACA,aAAK,YAAL,GAAoB,KAAK,YAAL,IAAqB,EAAzC;AACA,aAAK,YAAL,CAAkB,SAAlB,GAA8B,IAA9B;AACD;AACF,KAVM,MAUA;AACL,WAAK,UAAL,GAAkB,KAAK,UAAL,CAAgB,KAAlC;AACD;AACF;;AAED,MAAI,KAAK,IAAL,KAAc,KAAlB,EAAyB;AACvB,SAAK,KAAL,GAAa,KAAb;AACD,GAFD,MAEO;AACL,SAAK,KAAL,GAAa,KAAK,KAAL,IAAc,KAAK,WAAL,EAA3B;AACD;;AAED,OAAK,EAAL,CAAQ,MAAR,EAAgB,UAAU,GAAV,EAAe;AAC7B,QAAI,KAAK,KAAL,IAAc,KAAK,QAAvB,EAAiC;AAC/B,WAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,wEAAV,CAAnB;AACD;AACD,SAAK,GAAL,GAAW,GAAX;AACA,QAAI,aAAa,GAAb,CAAJ,EAAuB;AACrB,UAAI,CAAC,KAAK,SAAL,CAAe,cAAf,CAAL,EAAqC;AACnC,aAAK,SAAL,CAAe,cAAf,EAA+B,KAAK,MAAL,CAAY,IAAI,IAAhB,CAA/B;AACD;AACF,KAJD,MAIO;AACL,UAAI,IAAI,OAAR,EAAiB;AACf,aAAK,IAAI,CAAT,IAAc,IAAI,OAAlB,EAA2B;AACzB,cAAI,CAAC,KAAK,SAAL,CAAe,CAAf,CAAL,EAAwB;AACtB,iBAAK,SAAL,CAAe,CAAf,EAAkB,IAAI,OAAJ,CAAY,CAAZ,CAAlB;AACD;AACF;AACF;AACD,UAAI,KAAK,KAAL,IAAc,CAAC,KAAK,SAAL,CAAe,cAAf,CAAnB,EAAmD;AACjD,aAAK,SAAL,CAAe,cAAf,EAA+B,kBAA/B;AACD;AACD,UAAI,IAAI,MAAJ,IAAc,CAAC,KAAK,cAAxB,EAAwC;AACtC,aAAK,MAAL,GAAc,IAAI,MAAlB;AACD;AACF;;;;;AAKF,GA5BD;;AA8BA,QAAM,YAAY;AAChB,QAAI,KAAK,QAAT,EAAmB;AACjB;AACD;;AAED,QAAI,MAAM,YAAY;AACpB,UAAI,KAAK,KAAT,EAAgB;AACd,YAAI,CAAC,KAAK,KAAL,CAAW,OAAhB,EAAyB;AACvB,eAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACD,SAFD,MAGK,IAAI,KAAK,KAAL,CAAW,OAAX,IAAsB,KAAK,KAAL,CAAW,QAArC,EAA+C;AAClD,eAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACD;AACF;AACD,UAAI,KAAK,UAAL,IAAmB,KAAK,UAAL,CAAgB,OAAvC,EAAgD;AAC9C,aAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAA0B,IAA1B;AACD;AACD,UAAI,KAAK,IAAT,EAAe;AACb,YAAI,SAAS,KAAK,IAAd,CAAJ,EAAyB;AACvB,eAAK,IAAL,CAAU,IAAV,CAAe,IAAf;AACD,SAFD,MAEO;AACL;AACA,cAAI,MAAM,OAAN,CAAc,KAAK,IAAnB,CAAJ,EAA8B;AAC5B,iBAAK,IAAL,CAAU,OAAV,CAAkB,UAAU,IAAV,EAAgB;AAChC,mBAAK,KAAL,CAAW,IAAX;AACD,aAFD;AAGD,WAJD,MAIO;AACL,iBAAK,KAAL,CAAW,KAAK,IAAhB;AACD;AACD,eAAK,GAAL;AACD;AACF,OAdD,MAcO,IAAI,KAAK,iBAAT,EAA4B;AACjC,gBAAQ,IAAR,CAAa,yFAAb;AACA,aAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B;AACD,OAHM,MAGA,IAAI,CAAC,KAAK,GAAV,EAAe;AACpB,YAAI,KAAK,KAAL,CAAW,OAAX,IAAsB,CAAC,KAAK,KAAL,CAAW,QAAtC,EAAgD;AAC9C,eAAK,GAAL;AACA;AACD;AACD,YAAI,KAAK,MAAL,KAAgB,KAAhB,IAAyB,OAAO,KAAK,MAAZ,KAAuB,WAApD,EAAiE;AAC/D,eAAK,SAAL,CAAe,gBAAf,EAAiC,CAAjC;AACD;AACD,aAAK,GAAL;AACD;AACF,KAvCD;;AAyCA,QAAI,KAAK,KAAL,IAAc,CAAC,KAAK,SAAL,CAAe,gBAAf,CAAnB,EAAqD;;AAEnD,WAAK,SAAL,CAAe,KAAK,KAAL,CAAW,UAAX,EAAf,EAAwC,IAAxC;AACA,WAAK,KAAL,CAAW,SAAX,CAAqB,UAAU,GAAV,EAAe,MAAf,EAAuB;AAC1C,YAAI,CAAC,GAAD,IAAQ,CAAC,MAAM,MAAN,CAAb,EAA4B;AAC1B,eAAK,SAAL,CAAe,gBAAf,EAAiC,MAAjC;AACD;AACD;AACD,OALD;AAMD,KATD,MASO;AACL;AACD;;AAED,SAAK,KAAL,GAAa,IAAb;AACD,GA5DD;AA8DD,CA5bD;;AA8bA,QAAQ,SAAR,CAAkB,WAAlB,GAAgC,YAAY;AAC1C,MAAI,OAAO,IAAX;AACA,MAAI,QAAQ,KAAK,UAAjB;AACA,MAAI,UAAU,EAAd;AACA,MAAI,KAAK,YAAT,EAAuB;AACrB,SAAK,IAAI,CAAT,IAAc,KAAK,YAAnB,EAAiC;AAC/B,cAAQ,CAAR,IAAa,KAAK,YAAL,CAAkB,CAAlB,CAAb;AACD;AACF;AACD,MAAI,KAAK,EAAT,EAAa;AACX,YAAQ,EAAR,GAAa,KAAK,EAAlB;AACD;AACD,MAAI,KAAK,OAAT,EAAkB;AAChB,YAAQ,OAAR,GAAkB,KAAK,OAAvB;AACD;AACD,MAAI,KAAK,cAAT,EAAyB;AACvB,YAAQ,cAAR,GAAyB,KAAK,cAA9B;AACD;AACD,MAAI,KAAK,aAAT,EAAwB;AACtB,YAAQ,aAAR,GAAwB,KAAK,aAA7B;AACD;AACD,MAAI,OAAO,KAAK,kBAAZ,KAAmC,WAAvC,EAAoD;AAClD,YAAQ,kBAAR,GAA6B,KAAK,kBAAlC;AACD;;AAED,MAAI,KAAK,IAAL,IAAa,KAAK,GAAtB,EAA2B;AACzB,YAAQ,GAAR,GAAc,KAAK,GAAnB;AACA,YAAQ,IAAR,GAAe,KAAK,IAApB;AACD;;AAED,MAAI,KAAK,GAAT,EAAc;AACZ,YAAQ,GAAR,GAAc,KAAK,GAAnB;AACD;;AAED,MAAI,KAAK,UAAT,EAAqB;AACnB,YAAQ,UAAR,GAAqB,KAAK,UAA1B;AACD;;AAED,MAAI,UAAU,EAAd;;;AAGA,MAAI,UAAU,KAAK,UAAL,CAAgB,KAA9B,EAAqC;AACnC,eAAW,MAAM,IAAjB;AACD;;;AAGD,MAAI,QAAQ,KAAK,KAAjB;AACA,MAAI,OAAO,KAAP,KAAiB,QAArB,EAA+B;AAC7B,YAAQ,IAAI,KAAJ,CAAU,KAAV,CAAR;AACD;AACD,MAAI,UAAW,SAAS,MAAM,QAAN,KAAmB,QAA7B,IAA0C,KAAK,GAAL,CAAS,QAAT,KAAsB,QAA9E;;AAEA,MAAI,OAAJ,EAAa;AACX,QAAI,QAAQ,EAAZ,EAAgB;AACd,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,EAAnB;AACD;;AAED,QAAI,OAAO,QAAQ,kBAAf,KAAsC,WAA1C,EAAuD;AACrD,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,kBAAnB;AACD;;AAED,QAAI,QAAQ,IAAZ,EAAkB;AAChB,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,IAAR,CAAa,QAAb,CAAsB,OAAtB,IAAiC,QAAQ,GAAR,CAAY,QAAZ,CAAqB,OAArB,CAA5C;AACD;;AAED,QAAI,QAAQ,GAAZ,EAAiB;AACf,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,GAAR,CAAY,QAAZ,CAAqB,OAArB,CAAX;AACD;;AAED,QAAI,QAAQ,OAAZ,EAAqB;AACnB,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,OAAnB;AACD;;AAED,QAAI,QAAQ,cAAZ,EAA4B;AAC1B,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,cAAnB;AACD;;AAED,QAAI,QAAQ,aAAZ,EAA2B;AACzB,UAAI,OAAJ,EAAa;AACX,mBAAW,GAAX;AACD;AACD,iBAAW,QAAQ,aAAnB;AACD;AACF;;AAED,MAAI,KAAK,IAAL,KAAc,UAAd,IAA4B,CAAC,OAA7B,IAAwC,OAAO,IAAP,CAAY,OAAZ,EAAqB,MAArB,KAAgC,CAAxE,IAA6E,KAAK,UAAL,CAAgB,WAAjG,EAA8G;;AAE5G,WAAO,KAAK,UAAL,CAAgB,WAAvB;AACD;;;AAGD,YAAU,KAAK,GAAL,CAAS,QAAT,GAAoB,OAA9B;;;AAGA,MAAI,CAAC,KAAK,IAAL,CAAU,OAAV,CAAL,EAAyB;AACvB,SAAK,IAAL,CAAU,OAAV,IAAqB,IAAI,KAAJ,CAAU,OAAV,CAArB;;AAEA,QAAI,KAAK,IAAL,CAAU,UAAd,EAA0B;AACxB,WAAK,IAAL,CAAU,OAAV,EAAmB,UAAnB,GAAgC,KAAK,IAAL,CAAU,UAA1C;AACD;AACF;;AAED,SAAO,KAAK,IAAL,CAAU,OAAV,CAAP;AACD,CAzHD;;AA2HA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,YAAY;;;AAGpC,MAAI,OAAO,IAAX;;AAEA,MAAI,KAAK,QAAT,EAAmB;AACjB;AACD;;AAED,OAAK,QAAL,GAAgB,IAAhB;AACA,OAAK,MAAL,GAAc,KAAK,MAAL,IAAe,KAA7B;AACA,OAAK,IAAL,GAAY,KAAK,GAAL,CAAS,IAArB;;AAEA,MAAI,KAAK,GAAL,IAAY,KAAK,GAAL,CAAS,IAArB,IAA6B,KAAK,GAAL,CAAS,IAAT,CAAc,IAA3C,IAAmD,CAAC,KAAK,SAAL,CAAe,gBAAf,CAAxD,EAA0F;AACxF,SAAK,SAAL,CAAe,gBAAf,EAAiC,KAAK,GAAL,CAAS,IAAT,CAAc,IAA/C;AACD;AACD,MAAI,KAAK,IAAT,EAAe;AACb,SAAK,GAAL,CAAS,KAAK,IAAd,EAAoB,IAApB;AACD;;;;AAID,MAAI,aAAa,KAAK,IAAL,CAAjB;AACA,SAAO,WAAW,IAAlB;;AAEA,QAAM,cAAN,EAAsB,KAAK,GAAL,CAAS,IAA/B;;;;;AAKA,SAAO,WAAW,OAAlB;;AAEA,MAAI;AACF,SAAK,GAAL,GAAW,KAAK,UAAL,CAAgB,OAAhB,CAAwB,UAAxB,CAAX;AACD,GAFD,CAEE,OAAO,GAAP,EAAY;AACZ,SAAK,IAAL,CAAU,OAAV,EAAmB,GAAnB;AACA;AACD;;AAED,MAAI,KAAK,MAAT,EAAiB;AACf,SAAK,SAAL,GAAiB,IAAI,IAAJ,GAAW,OAAX,EAAjB;AACD;;AAED,MAAI,OAAJ;AACA,MAAI,KAAK,OAAL,IAAgB,CAAC,KAAK,YAA1B,EAAwC;AACtC,QAAI,KAAK,OAAL,GAAe,CAAnB,EAAsB;AACpB,gBAAU,CAAV;AACD,KAFD,MAEO,IAAI,OAAO,KAAK,OAAZ,KAAwB,QAAxB,IAAoC,SAAS,KAAK,OAAd,CAAxC,EAAgE;AACrE,gBAAU,KAAK,OAAf;AACD;AACF;;AAED,OAAK,GAAL,CAAS,EAAT,CAAY,UAAZ,EAAwB,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAxB;AACA,OAAK,GAAL,CAAS,EAAT,CAAY,OAAZ,EAAqB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAArB;AACA,OAAK,GAAL,CAAS,EAAT,CAAY,OAAZ,EAAqB,YAAW;AAC9B,SAAK,IAAL,CAAU,OAAV;AACD,GAFD;AAGA,OAAK,GAAL,CAAS,EAAT,CAAY,QAAZ,EAAsB,UAAS,MAAT,EAAiB;AACrC,QAAI,gBAAgB,YAAW;;;;;;AAM7B,WAAK,GAAL,CAAS,UAAT,CAAoB,OAApB,EAA6B,YAAY;AACvC,YAAI,KAAK,GAAT,EAAc;AACZ,eAAK,KAAL;AACA,cAAI,IAAI,IAAI,KAAJ,CAAU,iBAAV,CAAR;AACA,YAAE,IAAF,GAAS,iBAAT;AACA,YAAE,OAAF,GAAY,KAAZ;AACA,eAAK,IAAL,CAAU,OAAV,EAAmB,CAAnB;AACD;AACF,OARD;AASD,KAfD;;AAiBA,QAAI,eAAe,OAAO,WAAP,IAAsB,OAAO,UAAhD;AACA,QAAI,YAAY,SAAhB,EAA2B;;;;;AAKzB,UAAI,YAAJ,EAAkB;AAChB,YAAI,mBAAmB,YAAW;AAChC,iBAAO,cAAP,CAAsB,SAAtB,EAAiC,gBAAjC;AACA,uBAAa,KAAK,YAAlB;AACA,eAAK,YAAL,GAAoB,IAApB;AACA;AACD,SALD;;AAOA,eAAO,EAAP,CAAU,SAAV,EAAqB,gBAArB;;AAEA,aAAK,GAAL,CAAS,EAAT,CAAY,OAAZ,EAAqB,UAAS,GAAT,EAAc;AACjC,iBAAO,cAAP,CAAsB,SAAtB,EAAiC,gBAAjC;AACD,SAFD;;;;;;AAQA,aAAK,YAAL,GAAoB,WAAW,YAAY;AACzC,iBAAO,cAAP,CAAsB,SAAtB,EAAiC,gBAAjC;AACA,eAAK,KAAL;AACA,cAAI,IAAI,IAAI,KAAJ,CAAU,WAAV,CAAR;AACA,YAAE,IAAF,GAAS,WAAT;AACA,YAAE,OAAF,GAAY,IAAZ;AACA,eAAK,IAAL,CAAU,OAAV,EAAmB,CAAnB;AACD,SAPmB,EAOjB,OAPiB,CAApB;AAQD,OA1BD,MA0BO;;AAEL;AACD;AACF;AACD,SAAK,IAAL,CAAU,QAAV,EAAoB,MAApB;AACD,GAxDD;;AA0DA,OAAK,IAAL,CAAU,SAAV,EAAqB,KAAK,GAA1B;AACD,CApHD;;AAsHA,QAAQ,SAAR,CAAkB,cAAlB,GAAmC,UAAU,KAAV,EAAiB;AAClD,MAAI,OAAO,IAAX;AACA,MAAI,KAAK,QAAT,EAAmB;AACjB;AACD;AACD,MAAI,KAAK,GAAL,IAAY,KAAK,GAAL,CAAS,aAArB,IAAsC,MAAM,IAAN,KAAe,YAArD,IACG,KAAK,KAAL,CAAW,iBADlB,EACqC;AACnC,SAAK,KAAL,GAAa,EAAE,YAAY,KAAK,KAAL,CAAW,iBAAX,CAA6B,IAA7B,CAAkC,KAAK,KAAvC,CAAd,EAAb;AACA,SAAK,KAAL;AACA,SAAK,GAAL,CAAS,GAAT;AACA;AACD;AACD,MAAI,KAAK,OAAL,IAAgB,KAAK,YAAzB,EAAuC;AACrC,iBAAa,KAAK,YAAlB;AACA,SAAK,YAAL,GAAoB,IAApB;AACD;AACD,OAAK,IAAL,CAAU,OAAV,EAAmB,KAAnB;AACD,CAjBD;;AAmBA,QAAQ,SAAR,CAAkB,iBAAlB,GAAsC,UAAU,QAAV,EAAoB;AACxD,MAAI,OAAO,IAAX;AACA,QAAM,mBAAN,EAA2B,KAAK,GAAL,CAAS,IAApC,EAA0C,SAAS,UAAnD,EAA+D,SAAS,OAAxE;AACA,WAAS,EAAT,CAAY,KAAZ,EAAmB,YAAW;AAC5B,QAAI,KAAK,MAAT,EAAiB;AACf,WAAK,WAAL,IAAqB,IAAI,IAAJ,GAAW,OAAX,KAAuB,KAAK,SAAjD;AACA,YAAM,cAAN,EAAsB,KAAK,WAA3B;AACA,eAAS,WAAT,GAAuB,KAAK,WAA5B;AACD;AACD,UAAM,cAAN,EAAsB,KAAK,GAAL,CAAS,IAA/B,EAAqC,SAAS,UAA9C,EAA0D,SAAS,OAAnE;AACD,GAPD;;AASA,MAAI,KAAK,QAAT,EAAmB;AACjB,UAAM,SAAN,EAAiB,KAAK,GAAL,CAAS,IAA1B;AACA,aAAS,MAAT;AACA;AACD;;AAED,OAAK,QAAL,GAAgB,QAAhB;AACA,WAAS,OAAT,GAAmB,IAAnB;AACA,WAAS,MAAT,GAAkB,cAAlB;;;AAGA,MAAI,KAAK,UAAL,KAAoB,KAApB,IACA,KAAK,SADL,KACmB,CAAC,SAAS,cAAT,CAAwB,QAAxB,CAAD,IACnB,CAAC,SAAS,MAAT,CAAgB,UAFjB,CAAJ,EAEkC;AAChC,UAAM,kBAAN,EAA0B,KAAK,GAAL,CAAS,IAAnC;AACA,QAAI,SAAS,SAAS,cAAT,CAAwB,QAAxB,IAAoC,SAAS,MAAT,CAAgB,kBAApD,GAAyE,KAAK,GAAL,CAAS,IAAT,GAAgB,uBAAtG;AACA,SAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,gBAAgB,MAA1B,CAAnB;AACA;AACD;;;;;;AAMD,OAAK,YAAL,GAAoB,KAAK,SAAL,CAAe,MAAf,CAApB;AACA,MAAI,CAAC,KAAK,sBAAV,EAAkC;AAChC,SAAK,sBAAL,GAA8B,KAAK,SAAL,CAAe,MAAf,CAA9B;AACD;AACD,MAAI,KAAK,OAAT,EAAkB;AAChB,SAAK,YAAL,CAAkB,MAAlB;AACD;AACD,MAAI,KAAK,OAAL,IAAgB,KAAK,YAAzB,EAAuC;AACrC,iBAAa,KAAK,YAAlB;AACA,SAAK,YAAL,GAAoB,IAApB;AACD;;AAED,MAAI,kBAAmB,KAAK,IAAL,IAAa,KAAK,IAAL,CAAU,SAAxB,GAAqC,KAAK,IAA1C,GAAiD,eAAvE;AACA,MAAI,YAAY,UAAU,MAAV,EAAkB;;AAEhC,QAAI;AACF,sBAAgB,SAAhB,CAA0B,MAA1B,EAAkC,KAAK,GAAL,CAAS,IAA3C,EAAiD,EAAC,aAAa,IAAd,EAAjD;AACD,KAFD,CAEE,OAAO,CAAP,EAAU;AACV,WAAK,IAAL,CAAU,OAAV,EAAmB,CAAnB;AACD;AACF,GAPD;;AASA,WAAS,QAAT,GAAoB,SAAS,SAAS,OAAlB,CAApB;;AAEA,MAAI,SAAS,QAAT,CAAkB,GAAlB,CAAsB,YAAtB,KAAwC,CAAC,KAAK,eAAlD,EAAoE;AAClE,QAAI,aAAa,SAAS,QAAT,CAAkB,GAAlB,CAAsB,YAAtB,CAAjB;AACA,QAAI,MAAM,OAAN,CAAc,SAAS,OAAT,CAAiB,UAAjB,CAAd,CAAJ,EAAiD;AAC/C,eAAS,OAAT,CAAiB,UAAjB,EAA6B,OAA7B,CAAqC,SAArC;AACD,KAFD,MAEO;AACL,gBAAU,SAAS,OAAT,CAAiB,UAAjB,CAAV;AACD;AACF;;AAED,MAAI,KAAK,SAAL,CAAe,UAAf,CAA0B,QAA1B,CAAJ,EAAyC;AACvC,W;AACD,GAFD,MAEO;;;AAGL,eAAS,EAAT,CAAY,OAAZ,EAAqB,YAAY;AAC/B,YAAI,CAAC,KAAK,MAAV,EAAkB;AAChB,eAAK,QAAL,CAAc,IAAd,CAAmB,KAAnB;AACD;AACF,OAJD;;AAMA,eAAS,IAAT,CAAc,KAAd,EAAqB,YAAY;AAC/B,aAAK,MAAL,GAAc,IAAd;AACD,OAFD;;AAIA,UAAI,SAAS,UAAU,IAAV,EAAgB;AAC3B,eACE,KAAK,MAAL,KAAgB;;AAAhB,YAEI,QAAQ,GAAR,IAAe,OAAO;;AAF1B,YAIG,SAAS;;AAJZ,YAMG,SAAS,GAPd;AASD,OAVD;;AAYA,UAAI,eAAJ;AACA,UAAI,KAAK,IAAL,IAAa,CAAC,OAAO,SAAS,UAAhB,CAAlB,EAA+C;AAC7C,YAAI,kBAAkB,SAAS,OAAT,CAAiB,kBAAjB,KAAwC,UAA9D;AACA,0BAAkB,gBAAgB,IAAhB,GAAuB,WAAvB,EAAlB;;AAEA,YAAI,oBAAoB,MAAxB,EAAgC;AAC9B,4BAAkB,KAAK,YAAL,EAAlB;AACA,mBAAS,IAAT,CAAc,eAAd;AACD,SAHD,MAGO,IAAI,oBAAoB,SAAxB,EAAmC;AACxC,4BAAkB,KAAK,aAAL,EAAlB;AACA,mBAAS,IAAT,CAAc,eAAd;AACD,SAHM,MAGA;;;AAGL,cAAI,oBAAoB,UAAxB,EAAoC;AAClC,kBAAM,4CAA4C,eAAlD;AACD;AACD,4BAAkB,QAAlB;AACD;AACF,OAlBD,MAkBO;AACL,0BAAkB,QAAlB;AACD;;AAED,UAAI,KAAK,QAAT,EAAmB;AACjB,YAAI,KAAK,KAAL,CAAW,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,kBAAQ,KAAR,CAAc,sHAAd;AACD,SAFD,MAEO,IAAI,gBAAgB,WAApB,EAAiC;AACtC,0BAAgB,WAAhB,CAA4B,KAAK,QAAjC;AACD,SAFM,MAEA;;;;AAIL,4BAAkB,gBAAgB,IAAhB,CAAqB,aAAa,KAAK,QAAlB,CAArB,CAAlB;AACD;AACF;;AAED,UAAI,KAAK,OAAT,EAAkB;AAChB,wBAAgB,KAAhB;AACD;;AAED,WAAK,eAAL,GAAuB,eAAvB;;AAEA,WAAK,IAAL,CAAU,UAAV,EAAsB,QAAtB;;AAEA,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAU,IAAV,EAAgB;AACjC,aAAK,QAAL,CAAc,IAAd;AACD,OAFD;;AAIA,sBAAgB,EAAhB,CAAmB,MAAnB,EAA2B,UAAU,KAAV,EAAiB;AAC1C,YAAI,KAAK,MAAL,IAAe,CAAC,KAAK,eAAzB,EAA0C;AACxC,eAAK,iBAAL,GAA0B,IAAI,IAAJ,EAAD,CAAa,OAAb,EAAzB;AACA,mBAAS,iBAAT,GAA6B,KAAK,iBAAlC;AACD;AACD,aAAK,SAAL,GAAiB,IAAjB;AACA,aAAK,IAAL,CAAU,MAAV,EAAkB,KAAlB;AACD,OAPD;AAQA,sBAAgB,IAAhB,CAAqB,KAArB,EAA4B,UAAU,KAAV,EAAiB;AAC3C,aAAK,IAAL,CAAU,KAAV,EAAiB,KAAjB;AACD,OAFD;AAGA,sBAAgB,EAAhB,CAAmB,OAAnB,EAA4B,UAAU,KAAV,EAAiB;AAC3C,aAAK,IAAL,CAAU,OAAV,EAAmB,KAAnB;AACD,OAFD;AAGA,sBAAgB,EAAhB,CAAmB,OAAnB,EAA4B,YAAY;AAAC,aAAK,IAAL,CAAU,OAAV;AAAmB,OAA5D;;AAEA,UAAI,KAAK,QAAT,EAAmB;AACjB,aAAK,gBAAL,CAAsB,QAAtB;AACD;;AAFD,WAIK;AACH,eAAK,EAAL,CAAQ,KAAR,EAAe,YAAY;AACzB,gBAAI,KAAK,QAAT,EAAmB;AACjB,oBAAM,SAAN,EAAiB,KAAK,GAAL,CAAS,IAA1B;AACA;AACD;AACD,iBAAK,IAAL,CAAU,UAAV,EAAsB,QAAtB;AACD,WAND;AAOD;AACF;AACD,QAAM,sBAAN,EAA8B,KAAK,GAAL,CAAS,IAAvC;AACD,CA/KD;;AAiLA,QAAQ,SAAR,CAAkB,gBAAlB,GAAqC,UAAU,QAAV,EAAoB;AACvD,MAAI,OAAO,IAAX;AACA,QAAM,0BAAN;AACA,MAAI,UAAU,EAAd;MACI,eAAe,CADnB;MAEI,UAAU,EAFd;;AAIA,OAAK,EAAL,CAAQ,MAAR,EAAgB,UAAU,KAAV,EAAiB;AAC/B,QAAI,CAAC,OAAO,QAAP,CAAgB,KAAhB,CAAL,EAA6B;AAC3B,cAAQ,IAAR,CAAa,KAAb;AACD,KAFD,MAEO,IAAI,MAAM,MAAV,EAAkB;AACvB,sBAAgB,MAAM,MAAtB;AACA,cAAQ,IAAR,CAAa,KAAb;AACD;AACF,GAPD;AAQA,OAAK,EAAL,CAAQ,KAAR,EAAe,YAAY;AACzB,UAAM,WAAN,EAAmB,KAAK,GAAL,CAAS,IAA5B;AACA,QAAI,KAAK,QAAT,EAAmB;AACjB,YAAM,SAAN,EAAiB,KAAK,GAAL,CAAS,IAA1B;;;AAGA,gBAAU,EAAV;AACA,qBAAe,CAAf;AACA;AACD;;AAED,QAAI,YAAJ,EAAkB;AAChB,YAAM,UAAN,EAAkB,KAAK,GAAL,CAAS,IAA3B,EAAiC,YAAjC;AACA,eAAS,IAAT,GAAgB,OAAO,MAAP,CAAc,OAAd,EAAuB,YAAvB,CAAhB;AACA,UAAI,KAAK,QAAL,KAAkB,IAAtB,EAA4B;AAC1B,iBAAS,IAAT,GAAgB,SAAS,IAAT,CAAc,QAAd,CAAuB,KAAK,QAA5B,CAAhB;AACD;;;AAGD,gBAAU,EAAV;AACA,qBAAe,CAAf;AACD,KAVD,MAUO,IAAI,QAAQ,MAAZ,EAAoB;;;AAGzB,UAAI,KAAK,QAAL,KAAkB,MAAlB,IAA4B,QAAQ,CAAR,EAAW,MAAX,GAAoB,CAAhD,IAAqD,QAAQ,CAAR,EAAW,CAAX,MAAkB,QAA3E,EAAqF;AACnF,gBAAQ,CAAR,IAAa,QAAQ,CAAR,EAAW,SAAX,CAAqB,CAArB,CAAb;AACD;AACD,eAAS,IAAT,GAAgB,QAAQ,IAAR,CAAa,EAAb,CAAhB;AACD;;AAED,QAAI,KAAK,KAAT,EAAgB;AACd,UAAI;AACF,iBAAS,IAAT,GAAgB,KAAK,KAAL,CAAW,SAAS,IAApB,EAA0B,KAAK,YAA/B,CAAhB;AACD,OAFD,CAEE,OAAO,CAAP,EAAU;AACV,cAAM,uBAAN,EAA+B,KAAK,GAAL,CAAS,IAAxC;AACD;AACF;AACD,UAAM,mBAAN,EAA2B,KAAK,GAAL,CAAS,IAApC;AACA,QAAI,OAAO,SAAS,IAAhB,KAAyB,WAAzB,IAAwC,CAAC,KAAK,KAAlD,EAAyD;AACvD,eAAS,IAAT,GAAgB,KAAK,QAAL,KAAkB,IAAlB,GAAyB,IAAI,MAAJ,CAAW,CAAX,CAAzB,GAAyC,EAAzD;AACD;AACD,SAAK,IAAL,CAAU,UAAV,EAAsB,QAAtB,EAAgC,SAAS,IAAzC;AACD,GA1CD;AA2CD,CA1DD;;AA4DA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,YAAY;AACpC,MAAI,OAAO,IAAX;AACA,OAAK,QAAL,GAAgB,IAAhB;;AAEA,MAAI,KAAK,GAAT,EAAc;AACZ,SAAK,GAAL,CAAS,KAAT;AACD,GAFD,MAGK,IAAI,KAAK,QAAT,EAAmB;AACtB,SAAK,QAAL,CAAc,OAAd;AACD;;AAED,OAAK,IAAL,CAAU,OAAV;AACD,CAZD;;AAcA,QAAQ,SAAR,CAAkB,QAAlB,GAA6B,UAAU,IAAV,EAAgB;AAC3C,MAAI,OAAO,IAAX;AACA,MAAI,WAAW,KAAK,QAApB;;AAEA,MAAI,KAAK,OAAL,IAAgB,CAAC,KAAK,WAA1B,EAAuC;AACrC,QAAI,SAAS,QAAT,CAAkB,GAAlB,CAAsB,cAAtB,CAAJ,EAA2C;AACzC,UAAI,SAAS,SAAS,QAAT,CAAkB,GAAlB,CAAsB,cAAtB,CAAb;AACA,UAAI,KAAK,SAAT,EAAoB;AAClB,aAAK,SAAL,CAAe,MAAf,EAAuB,SAAS,OAAT,CAAiB,MAAjB,CAAvB;AACD,OAFD,MAGK;AACH,aAAK,OAAL,CAAa,MAAb,IAAuB,SAAS,OAAT,CAAiB,MAAjB,CAAvB;AACD;AACF;;AAED,QAAI,SAAS,QAAT,CAAkB,GAAlB,CAAsB,gBAAtB,CAAJ,EAA6C;AAC3C,UAAI,SAAS,SAAS,QAAT,CAAkB,GAAlB,CAAsB,gBAAtB,CAAb;AACA,UAAI,KAAK,SAAT,EAAoB;AAClB,aAAK,SAAL,CAAe,MAAf,EAAuB,SAAS,OAAT,CAAiB,MAAjB,CAAvB;AACD,OAFD,MAEO;AACL,aAAK,OAAL,CAAa,MAAb,IAAuB,SAAS,OAAT,CAAiB,MAAjB,CAAvB;AACD;AACF;AACF;AACD,MAAI,KAAK,SAAL,IAAkB,CAAC,KAAK,WAA5B,EAAyC;AACvC,SAAK,IAAI,CAAT,IAAc,SAAS,OAAvB,EAAgC;;;AAG9B,UAAI,CAAC,KAAK,IAAN,IAAc,MAAM,kBAAxB,EAA4C;AAC1C,aAAK,SAAL,CAAe,CAAf,EAAkB,SAAS,OAAT,CAAiB,CAAjB,CAAlB;AACD;AACF;AACD,SAAK,UAAL,GAAkB,SAAS,UAA3B;AACD;AACD,MAAI,KAAK,UAAT,EAAqB;AACnB,SAAK,UAAL,CAAgB,QAAhB,EAA0B,IAA1B;AACD;AACF,CArCD;;AAuCA,QAAQ,SAAR,CAAkB,EAAlB,GAAuB,UAAU,CAAV,EAAa,OAAb,EAAsB;AAC3C,MAAI,OAAO,IAAX;AACA,MAAI,IAAJ;AACA,MAAI,CAAC,OAAD,IAAY,KAAK,GAAL,CAAS,KAAzB,EAAgC;AAC9B,WAAO,KAAK,GAAL,CAAS,KAAT,CAAe,KAAK,GAAL,CAAS,KAAxB,CAAP;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;;AAED,OAAK,IAAI,CAAT,IAAc,CAAd,EAAiB;AACf,SAAK,CAAL,IAAU,EAAE,CAAF,CAAV;AACD;;AAED,MAAI,KAAK,KAAK,GAAL,CAAS,SAAT,CAAmB,IAAnB,CAAT;;AAEA,MAAI,OAAO,EAAX,EAAe;AACb,WAAO,IAAP;AACD;;AAED,OAAK,GAAL,GAAW,IAAI,KAAJ,CAAU,KAAK,GAAL,CAAS,IAAT,CAAc,KAAd,CAAoB,GAApB,EAAyB,CAAzB,IAA8B,GAA9B,GAAoC,EAA9C,CAAX;AACA,OAAK,GAAL,GAAW,KAAK,GAAhB;AACA,OAAK,IAAL,GAAY,KAAK,GAAL,CAAS,IAArB;;AAEA,MAAI,KAAK,GAAL,CAAS,IAAT,KAAkB,MAAtB,EAA8B;AAC5B,SAAK,gBAAL;AACD;;AAED,SAAO,IAAP;AACD,CA5BD;AA6BA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,IAAV,EAAgB;AACvC,MAAI,OAAO,IAAX;AACA,MAAI,IAAJ,EAAU;AACR,QAAI,CAAC,wCAAwC,IAAxC,CAA6C,KAAK,SAAL,CAAe,cAAf,CAA7C,CAAL,EAAmF;AACjF,WAAK,SAAL,CAAe,cAAf,EAA+B,mCAA/B;AACD;AACD,SAAK,IAAL,GAAa,OAAO,IAAP,KAAgB,QAAjB,GACR,KAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,QAAL,CAAc,MAAd,CAAjB,CADQ,GAER,KAAK,GAAL,CAAS,SAAT,CAAmB,IAAnB,EAAyB,QAAzB,CAAkC,MAAlC,CAFJ;AAGA,WAAO,IAAP;AACD;;AAED,OAAK,KAAL,GAAa,IAAI,QAAJ,EAAb;AACA,OAAK,KAAL,CAAW,EAAX,CAAc,OAAd,EAAuB,UAAS,GAAT,EAAc;AACnC,QAAI,OAAJ,GAAc,gBAAgB,IAAI,OAAlC;AACA,SAAK,IAAL,CAAU,OAAV,EAAmB,GAAnB;AACA,SAAK,KAAL;AACD,GAJD;AAKA,SAAO,KAAK,KAAZ;AACD,CAnBD;AAoBA,QAAQ,SAAR,CAAkB,SAAlB,GAA8B,UAAU,SAAV,EAAqB;AACjD,MAAI,OAAO,IAAX;;AAEA,OAAK,UAAL,CAAgB,SAAhB,CAA0B,SAA1B;;AAEA,MAAI,CAAC,KAAK,UAAL,CAAgB,OAArB,EAA8B;AAC5B,SAAK,IAAL,GAAY,KAAK,UAAL,CAAgB,IAA5B;AACD;;AAED,SAAO,IAAP;AACD,CAVD;AAWA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,GAAV,EAAe;AACtC,MAAI,OAAO,IAAX;;AAEA,MAAI,CAAC,KAAK,SAAL,CAAe,QAAf,CAAL,EAA+B;AAC7B,SAAK,SAAL,CAAe,QAAf,EAAyB,kBAAzB;AACD;;AAED,MAAI,OAAO,KAAK,YAAZ,KAA6B,UAAjC,EAA6C;AAC3C,SAAK,aAAL,GAAqB,KAAK,YAA1B;AACD;;AAED,OAAK,KAAL,GAAa,IAAb;AACA,MAAI,OAAO,GAAP,KAAe,SAAnB,EAA8B;AAC5B,QAAI,KAAK,IAAL,KAAc,SAAlB,EAA6B;AAC3B,UAAI,CAAC,wCAAwC,IAAxC,CAA6C,KAAK,SAAL,CAAe,cAAf,CAA7C,CAAL,EAAmF;AACjF,aAAK,IAAL,GAAY,cAAc,KAAK,IAAnB,EAAyB,KAAK,aAA9B,CAAZ;AACD,OAFD,MAEO;AACL,aAAK,IAAL,GAAY,KAAK,GAAL,CAAS,OAAT,CAAiB,KAAK,IAAtB,CAAZ;AACD;AACD,UAAI,CAAC,KAAK,SAAL,CAAe,cAAf,CAAL,EAAqC;AACnC,aAAK,SAAL,CAAe,cAAf,EAA+B,kBAA/B;AACD;AACF;AACF,GAXD,MAWO;AACL,SAAK,IAAL,GAAY,cAAc,GAAd,EAAmB,KAAK,aAAxB,CAAZ;AACA,QAAI,CAAC,KAAK,SAAL,CAAe,cAAf,CAAL,EAAqC;AACnC,WAAK,SAAL,CAAe,cAAf,EAA+B,kBAA/B;AACD;AACF;;AAED,MAAI,OAAO,KAAK,WAAZ,KAA4B,UAAhC,EAA4C;AAC1C,SAAK,YAAL,GAAoB,KAAK,WAAzB;AACD;;AAED,SAAO,IAAP;AACD,CAnCD;AAoCA,QAAQ,SAAR,CAAkB,SAAlB,GAA8B,UAAU,IAAV,EAAgB,OAAhB,EAAyB;AACrD,MAAI,OAAO,IAAX;AACA,MAAI,MAAJ,EAAY,EAAZ,EAAgB,KAAhB;AACA,MAAI,CAAC,OAAL,EAAc;AACZ,cAAU,KAAK,OAAf;AACD;AACD,SAAO,IAAP,CAAY,OAAZ,EAAqB,OAArB,CAA6B,UAAU,GAAV,EAAe;AAC1C,QAAI,IAAI,MAAJ,KAAe,KAAK,MAAxB,EAAgC;AAC9B;AACD;AACD,SAAK,IAAI,MAAJ,CAAW,IAAX,EAAiB,GAAjB,CAAL;AACA,YAAQ,IAAI,KAAJ,CAAU,EAAV,CAAR;AACA,QAAI,KAAJ,EAAW;AACT,eAAS,QAAQ,GAAR,CAAT;AACD;AACF,GATD;AAUA,SAAO,MAAP;AACD,CAjBD;AAkBA,QAAQ,SAAR,CAAkB,gBAAlB,GAAqC,YAAY;;AAE/C,MAAI,YAAY,KAAK,GAAL,CAAS,IAAT,CAAc,KAAd,CAAoB,GAApB,CAAhB;MACI,OAAO,UAAU,CAAV,CADX;MAEI,OAAO,UAAU,CAAV,CAFX;;AAIA,OAAK,UAAL,GAAkB,IAAlB;AACA,OAAK,GAAL,CAAS,QAAT,GAAoB,IAApB;AACA,OAAK,GAAL,CAAS,IAAT,GAAgB,IAAhB;AACA,OAAK,GAAL,CAAS,IAAT,GAAgB,IAAhB;AACA,OAAK,GAAL,CAAS,QAAT,GAAoB,IAApB;AACA,OAAK,GAAL,CAAS,MAAT,GAAkB,IAAlB;AACD,CAZD;;AAeA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,IAAV,EAAgB,IAAhB,EAAsB,eAAtB,EAAuC,MAAvC,EAA+C;AACtE,MAAI,OAAO,IAAX;;AAEA,OAAK,KAAL,CAAW,SAAX,CAAqB,IAArB,EAA2B,IAA3B,EAAiC,eAAjC,EAAkD,MAAlD;;AAEA,SAAO,IAAP;AACD,CAND;AAOA,QAAQ,SAAR,CAAkB,GAAlB,GAAwB,UAAU,IAAV,EAAgB,GAAhB,EAAqB;AAC3C,MAAI,OAAO,IAAX;;AAEA,MAAI,CAAC,GAAL,EAAU;AACR,SAAK,IAAL,GAAY,IAAZ;AACA,WAAO,IAAP;AACD;;AAED,MAAI,KAAK,YAAL,IAAqB,CAArB,IAA0B,KAAK,YAAL,IAAqB,GAAnD,EAAwD;;AAEtD,QAAI,UAAU;AACZ,YAAM,KAAK,GAAL,CAAS,IADH;AAEZ,YAAM,KAAK,GAAL,CAAS,IAFH;AAGZ,cAAQ,KAAK,MAHD;AAIZ,eAAS;AACP,wBAAgB,KAAK,SAAL,CAAe,cAAf,KAAkC;AAD3C,OAJG;AAOZ,YAAM,KAAK;AAPC,KAAd;AASA,QAAI,UAAU,KAAK,IAAL,CAAU,OAAV,EAAmB;AAC/B,mBAAa,KAAK,GADa;AAE/B,uBAAiB,KAAK,MAFS;AAG/B,oBAAc,KAAK;AAHY,KAAnB,CAAd;AAKA,SAAK,SAAL,CAAe,eAAf,EAAgC,QAAQ,OAAR,CAAgB,aAAhD;AACA,SAAK,SAAL,CAAe,YAAf,EAA6B,QAAQ,OAAR,CAAgB,YAAhB,CAA7B;AACA,QAAI,QAAQ,OAAR,CAAgB,sBAAhB,CAAJ,EAA6C;AAC3C,WAAK,SAAL,CAAe,sBAAf,EAAuC,QAAQ,OAAR,CAAgB,sBAAhB,CAAvC;AACD;AACF,GArBD,MAsBK;;AAEH,QAAI,OAAO,IAAI,IAAJ,EAAX;AACA,SAAK,SAAL,CAAe,MAAf,EAAuB,KAAK,WAAL,EAAvB;AACA,QAAI,OACF,EAAE,KAAK,KAAK,GAAZ;AACE,cAAQ,KAAK,MADf;AAEE,YAAM,KAAK,MAAL,CAAY,WAAZ,EAFR;AAGE,YAAM,IAHR;AAIE,mBAAa,KAAK,SAAL,CAAe,cAAf,KAAkC,EAJjD;AAKE,WAAK,KAAK,SAAL,CAAe,aAAf,KAAiC,EALxC;AAME,qBAAe,KAAK,mBAAL,CAAyB,KAAK,OAA9B;AANjB,KADF;AASA,QAAI,OAAO,KAAK,GAAL,CAAS,IAApB;AACA,QAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACvB,WAAK,QAAL,GAAgB,MAAM,KAAK,MAAX,GAAoB,IAApC;AACD,KAFD,MAEO,IAAI,KAAK,MAAL,IAAe,CAAC,IAApB,EAA0B;AAC/B,WAAK,QAAL,GAAgB,MAAM,KAAK,MAA3B;AACD,KAFM,MAEA,IAAI,CAAC,KAAK,MAAN,IAAgB,IAApB,EAA0B;AAC/B,WAAK,QAAL,GAAgB,IAAhB;AACD,KAFM,MAEA,IAAI,CAAC,KAAK,MAAN,IAAgB,CAAC,IAArB,EAA2B;AAChC,WAAK,QAAL,GAAgB,GAAhB;AACD;AACD,SAAK,QAAL,GAAgB,KAAK,oBAAL,CAA0B,KAAK,QAA/B,CAAhB;AACA,SAAK,SAAL,CAAe,eAAf,EAAgC,KAAK,aAAL,CAAmB,IAAnB,CAAhC;AACD;;AAED,SAAO,IAAP;AACD,CA1DD;AA2DA,QAAQ,SAAR,CAAkB,aAAlB,GAAkC,UAAU,IAAV,EAAgB;AAChD,MAAI,OAAO,IAAX;AACA,gBAAc,WAAd,CAA0B;AACxB,eAAW,UAAS,MAAT,EAAiB;AAC1B,aAAO,KAAK,SAAL,CAAe,MAAf,EAAuB,KAAK,OAA5B,CAAP;AACD,KAHuB;AAIxB,eAAW,UAAS,MAAT,EAAiB,KAAjB,EAAwB;AACjC,WAAK,SAAL,CAAe,MAAf,EAAuB,KAAvB;AACD,KANuB;AAOxB,YAAQ,KAAK,MAPW;AAQxB,UAAM,KAAK;AARa,GAA1B,EASG,IATH;AAUA,QAAM,6BAAN,EAAqC,KAAK,SAAL,CAAe,eAAf,CAArC;;AAEA,SAAO,IAAP;AACD,CAfD;AAgBA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,IAAV,EAAgB;AACvC,MAAI,OAAO,IAAX;AACA,OAAK,SAAL,CAAe,eAAf,EAAgC,KAAK,MAAL,CAAY,MAAZ,CAAmB,KAAK,GAAxB,EAA6B,KAAK,MAAlC,EAA0C,IAA1C,EAAgD,KAAhF;AACD,CAHD;AAIA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,UAAU,MAAV,EAAkB;AAC1C,MAAI,OAAO,IAAX;;AAEA,OAAK,MAAL,CAAY,SAAZ,CAAsB,MAAtB;;AAEA,SAAO,IAAP;AACD,CAND;;AAQA,QAAQ,SAAR,CAAkB,GAAlB,GAAwB,UAAU,GAAV,EAAe;AACrC,MAAI,OAAO,IAAX;AACA,MAAI,OAAJ;;AAEA,MAAI,KAAK,SAAL,CAAe,iBAAf,KAAqC,CAAzC,EAA4C;AAC1C,SAAK,oBAAL,GAA4B,KAAK,SAAL,CAAe,QAAf,CAA5B;AACD;;AAED,MAAI,CAAC,GAAL,EAAU;;AAER,cAAU,KAAV;AACA,SAAK,eAAL,GAAuB,IAAvB;AACD,GAJD,MAIO;AACL,QAAI,kBAAmB,OAAO,IAAI,eAAZ,GAA+B,GAA/B,GAAqC,eAA3D;AACA,QAAI,UAAU,KAAK,GAAL,CAAS,IAAvB;;AAEA,QAAI,eAAJ,EAAqB;AACnB,gBAAU,gBAAgB,eAAhB,CAAgC,OAAhC,CAAV;AACD;AACF;;;AAGD,MAAI,WAAW,QAAQ,MAAvB,EAA+B;AAC7B,QAAI,KAAK,oBAAT,EAA+B;;AAE7B,WAAK,SAAL,CAAe,QAAf,EAAyB,KAAK,oBAAL,GAA4B,IAA5B,GAAmC,OAA5D;AACD,KAHD,MAGO;AACL,WAAK,SAAL,CAAe,QAAf,EAAyB,OAAzB;AACD;AACF;AACD,OAAK,IAAL,GAAY,GAAZ;AACA,SAAO,IAAP;AACD,CAhCD;;;AAoCA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,IAAV,EAAgB,IAAhB,EAAsB;AAC7C,MAAI,OAAO,IAAX;;AAEA,MAAI,KAAK,QAAT,EAAmB;AACjB,QAAI,KAAK,SAAT,EAAoB;AAClB,WAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,gEAAV,CAAnB;AACD,KAFD,MAEO,IAAI,KAAK,MAAT,EAAiB;AACtB,WAAK,IAAL,CAAU,OAAV,EAAmB,IAAI,KAAJ,CAAU,oDAAV,CAAnB;AACD,KAFM,MAEA;AACL,aAAO,MAAP,CAAc,SAAd,CAAwB,IAAxB,CAA6B,IAA7B,CAAkC,IAAlC,EAAwC,IAAxC,EAA8C,IAA9C;AACA,WAAK,QAAL,CAAc,IAAd;AACA,aAAO,IAAP;AACD;AACF,GAVD,MAUO;AACL,SAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACA,WAAO,MAAP,CAAc,SAAd,CAAwB,IAAxB,CAA6B,IAA7B,CAAkC,IAAlC,EAAwC,IAAxC,EAA8C,IAA9C;AACA,WAAO,IAAP;AACD;AACF,CAlBD;AAmBA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,YAAY;AACpC,MAAI,OAAO,IAAX;AACA,MAAI,KAAK,QAAT,EAAmB;AAAC;AAAO;;AAE3B,MAAI,CAAC,KAAK,QAAV,EAAoB;AAClB,SAAK,KAAL;AACD;AACD,MAAI,KAAK,GAAT,EAAc;AACZ,WAAO,KAAK,GAAL,CAAS,KAAT,CAAe,KAAf,CAAqB,KAAK,GAA1B,EAA+B,SAA/B,CAAP;AACD;AACF,CAVD;AAWA,QAAQ,SAAR,CAAkB,GAAlB,GAAwB,UAAU,KAAV,EAAiB;AACvC,MAAI,OAAO,IAAX;AACA,MAAI,KAAK,QAAT,EAAmB;AAAC;AAAO;;AAE3B,MAAI,KAAJ,EAAW;AACT,SAAK,KAAL,CAAW,KAAX;AACD;AACD,MAAI,CAAC,KAAK,QAAV,EAAoB;AAClB,SAAK,KAAL;AACD;AACD,MAAI,KAAK,GAAT,EAAc;AACZ,SAAK,GAAL,CAAS,GAAT;AACD;AACF,CAbD;AAcA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,YAAY;AACpC,MAAI,OAAO,IAAX;AACA,MAAI,CAAC,KAAK,eAAV,EAA2B;AACzB,SAAK,OAAL,GAAe,IAAf;AACD,GAFD,MAEO;AACL,SAAK,eAAL,CAAqB,KAArB,CAA2B,KAA3B,CAAiC,KAAK,eAAtC,EAAuD,SAAvD;AACD;AACF,CAPD;AAQA,QAAQ,SAAR,CAAkB,MAAlB,GAA2B,YAAY;AACrC,MAAI,OAAO,IAAX;AACA,MAAI,CAAC,KAAK,eAAV,EAA2B;AACzB,SAAK,OAAL,GAAe,KAAf;AACD,GAFD,MAEO;AACL,SAAK,eAAL,CAAqB,MAArB,CAA4B,KAA5B,CAAkC,KAAK,eAAvC,EAAwD,SAAxD;AACD;AACF,CAPD;AAQA,QAAQ,SAAR,CAAkB,OAAlB,GAA4B,YAAY;AACtC,MAAI,OAAO,IAAX;AACA,MAAI,CAAC,KAAK,MAAV,EAAkB;AAChB,SAAK,GAAL;AACD,GAFD,MAEO,IAAI,KAAK,QAAT,EAAmB;AACxB,SAAK,QAAL,CAAc,OAAd;AACD;AACF,CAPD;;AASA,QAAQ,2BAAR,GACE,OAAO,2BAAP,CAAmC,KAAnC,EADF;;AAGA,QAAQ,+BAAR,GACE,OAAO,+BAAP,CAAuC,KAAvC,EADF;;;;AAKA,QAAQ,SAAR,CAAkB,MAAlB,GAA2B,aAA3B;AACA,OAAO,OAAP,GAAiB,OAAjB","file":"request-compiled.js","sourcesContent":["'use strict'\n\nvar http = require('http')\n  , https = require('https')\n  , url = require('url')\n  , util = require('util')\n  , stream = require('stream')\n  , zlib = require('zlib')\n  , hawk = require('hawk')\n  , aws2 = require('aws-sign2')\n  , aws4 = require('aws4')\n  , httpSignature = require('http-signature')\n  , mime = require('mime-types')\n  , stringstream = require('stringstream')\n  , caseless = require('caseless')\n  , ForeverAgent = require('forever-agent')\n  , FormData = require('form-data')\n  , extend = require('extend')\n  , isstream = require('isstream')\n  , isTypedArray = require('is-typedarray').strict\n  , helpers = require('./lib/helpers')\n  , cookies = require('./lib/cookies')\n  , getProxyFromURI = require('./lib/getProxyFromURI')\n  , Querystring = require('./lib/querystring').Querystring\n  , Har = require('./lib/har').Har\n  , Auth = require('./lib/auth').Auth\n  , OAuth = require('./lib/oauth').OAuth\n  , Multipart = require('./lib/multipart').Multipart\n  , Redirect = require('./lib/redirect').Redirect\n  , Tunnel = require('./lib/tunnel').Tunnel\n\nvar safeStringify = helpers.safeStringify\n  , isReadStream = helpers.isReadStream\n  , toBase64 = helpers.toBase64\n  , defer = helpers.defer\n  , copy = helpers.copy\n  , version = helpers.version\n  , globalCookieJar = cookies.jar()\n\n\nvar globalPool = {}\n\nfunction filterForNonReserved(reserved, options) {\n  // Filter out properties that are not reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var notReserved = (reserved.indexOf(i) === -1)\n    if (notReserved) {\n      object[i] = options[i]\n    }\n  }\n  return object\n}\n\nfunction filterOutReservedFunctions(reserved, options) {\n  // Filter out properties that are functions and are reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var isReserved = !(reserved.indexOf(i) === -1)\n    var isFunction = (typeof options[i] === 'function')\n    if (!(isReserved && isFunction)) {\n      object[i] = options[i]\n    }\n  }\n  return object\n\n}\n\n// Return a simpler request object to allow serialization\nfunction requestToJSON() {\n  var self = this\n  return {\n    uri: self.uri,\n    method: self.method,\n    headers: self.headers\n  }\n}\n\n// Return a simpler response object to allow serialization\nfunction responseToJSON() {\n  var self = this\n  return {\n    statusCode: self.statusCode,\n    body: self.body,\n    headers: self.headers,\n    request: requestToJSON.call(self.request)\n  }\n}\n\nfunction Request (options) {\n  // if given the method property in options, set property explicitMethod to true\n\n  // extend the Request instance with any non-reserved properties\n  // remove any reserved functions from the options object\n  // set Request instance to be readable and writable\n  // call init\n\n  var self = this\n\n  // start with HAR, then override with additional options\n  if (options.har) {\n    self._har = new Har(self)\n    options = self._har.options(options)\n  }\n\n  stream.Stream.call(self)\n  var reserved = Object.keys(Request.prototype)\n  var nonReserved = filterForNonReserved(reserved, options)\n\n  extend(self, nonReserved)\n  options = filterOutReservedFunctions(reserved, options)\n\n  self.readable = true\n  self.writable = true\n  if (options.method) {\n    self.explicitMethod = true\n  }\n  self._qs = new Querystring(self)\n  self._auth = new Auth(self)\n  self._oauth = new OAuth(self)\n  self._multipart = new Multipart(self)\n  self._redirect = new Redirect(self)\n  self._tunnel = new Tunnel(self)\n  self.init(options)\n}\n\nutil.inherits(Request, stream.Stream)\n\n// Debugging\nRequest.debug = process.env.NODE_DEBUG && /\\brequest\\b/.test(process.env.NODE_DEBUG)\nfunction debug() {\n  if (Request.debug) {\n    console.error('REQUEST %s', util.format.apply(util, arguments))\n  }\n}\nRequest.prototype.debug = debug\n\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this\n  if (!options) {\n    options = {}\n  }\n  self.headers = self.headers ? copy(self.headers) : {}\n\n  // Delete headers with value undefined since they break\n  // ClientRequest.OutgoingMessage.setHeader in node 0.12\n  for (var headerName in self.headers) {\n    if (typeof self.headers[headerName] === 'undefined') {\n      delete self.headers[headerName]\n    }\n  }\n\n  caseless.httpify(self, self.headers)\n\n  if (!self.method) {\n    self.method = options.method || 'GET'\n  }\n  if (!self.localAddress) {\n    self.localAddress = options.localAddress\n  }\n\n  self._qs.init(options)\n\n  debug(options)\n  if (!self.pool && self.pool !== false) {\n    self.pool = globalPool\n  }\n  self.dests = self.dests || []\n  self.__isRequestRequest = true\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback\n    self.callback = function () {\n      if (self._callbackCalled) {\n        return // Print a warning maybe?\n      }\n      self._callbackCalled = true\n      self._callback.apply(self, arguments)\n    }\n    self.on('error', self.callback.bind())\n    self.on('complete', self.callback.bind(self, null))\n  }\n\n  // People use this property instead all the time, so support it\n  if (!self.uri && self.url) {\n    self.uri = self.url\n    delete self.url\n  }\n\n  // If there's a baseUrl, then use it as the base URL (i.e. uri must be\n  // specified as a relative path and is appended to baseUrl).\n  if (self.baseUrl) {\n    if (typeof self.baseUrl !== 'string') {\n      return self.emit('error', new Error('options.baseUrl must be a string'))\n    }\n\n    if (typeof self.uri !== 'string') {\n      return self.emit('error', new Error('options.uri must be a string when using options.baseUrl'))\n    }\n\n    if (self.uri.indexOf('//') === 0 || self.uri.indexOf('://') !== -1) {\n      return self.emit('error', new Error('options.uri must be a path when using options.baseUrl'))\n    }\n\n    // Handle all cases to make sure that there's only one slash between\n    // baseUrl and uri.\n    var baseUrlEndsWithSlash = self.baseUrl.lastIndexOf('/') === self.baseUrl.length - 1\n    var uriStartsWithSlash = self.uri.indexOf('/') === 0\n\n    if (baseUrlEndsWithSlash && uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri.slice(1)\n    } else if (baseUrlEndsWithSlash || uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri\n    } else if (self.uri === '') {\n      self.uri = self.baseUrl\n    } else {\n      self.uri = self.baseUrl + '/' + self.uri\n    }\n    delete self.baseUrl\n  }\n\n  // A URI is needed by this point, emit error if we haven't been able to get one\n  if (!self.uri) {\n    return self.emit('error', new Error('options.uri is a required argument'))\n  }\n\n  // If a string URI/URL was given, parse it into a URL object\n  if (typeof self.uri === 'string') {\n    self.uri = url.parse(self.uri)\n  }\n\n  // Some URL objects are not from a URL parsed string and need href added\n  if (!self.uri.href) {\n    self.uri.href = url.format(self.uri)\n  }\n\n  // DEPRECATED: Warning for users of the old Unix Sockets URL Scheme\n  if (self.uri.protocol === 'unix:') {\n    return self.emit('error', new Error('`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`'))\n  }\n\n  // Support Unix Sockets\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false\n  }\n\n  if (!self.uri.pathname) {self.uri.pathname = '/'}\n\n  if (!(self.uri.host || (self.uri.hostname && self.uri.port)) && !self.uri.isUnix) {\n    // Invalid URI: it may generate lot of bad errors, like 'TypeError: Cannot call method `indexOf` of undefined' in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri)\n    var message = 'Invalid URI \"' + faultyUri + '\"'\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (they didn't call request directly with this URL)\n      // they should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.'\n    }\n    // This error was fatal\n    self.abort()\n    return self.emit('error', new Error(message))\n  }\n\n  if (!self.hasOwnProperty('proxy')) {\n    self.proxy = getProxyFromURI(self.uri)\n  }\n\n  self.tunnel = self._tunnel.isEnabled()\n  if (self.proxy) {\n    self._tunnel.setup(options)\n  }\n\n  self._redirect.onRequest(options)\n\n  self.setHost = false\n  if (!self.hasHeader('host')) {\n    var hostHeaderName = self.originalHostHeaderName || 'host'\n    self.setHeader(hostHeaderName, self.uri.hostname)\n    if (self.uri.port) {\n      if ( !(self.uri.port === 80 && self.uri.protocol === 'http:') &&\n           !(self.uri.port === 443 && self.uri.protocol === 'https:') ) {\n        self.setHeader(hostHeaderName, self.getHeader('host') + (':' + self.uri.port) )\n      }\n    }\n    self.setHost = true\n  }\n\n  self.jar(self._jar || options.jar)\n\n  if (!self.uri.port) {\n    if (self.uri.protocol === 'http:') {self.uri.port = 80}\n    else if (self.uri.protocol === 'https:') {self.uri.port = 443}\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port\n    self.host = self.proxy.hostname\n  } else {\n    self.port = self.uri.port\n    self.host = self.uri.hostname\n  }\n\n  if (options.form) {\n    self.form(options.form)\n  }\n\n  if (options.formData) {\n    var formData = options.formData\n    var requestForm = self.form()\n    var appendFormValue = function (key, value) {\n      if (value && value.hasOwnProperty('value') && value.hasOwnProperty('options')) {\n        requestForm.append(key, value.value, value.options)\n      } else {\n        requestForm.append(key, value)\n      }\n    }\n    for (var formKey in formData) {\n      if (formData.hasOwnProperty(formKey)) {\n        var formValue = formData[formKey]\n        if (formValue instanceof Array) {\n          for (var j = 0; j < formValue.length; j++) {\n            appendFormValue(formKey, formValue[j])\n          }\n        } else {\n          appendFormValue(formKey, formValue)\n        }\n      }\n    }\n  }\n\n  if (options.qs) {\n    self.qs(options.qs)\n  }\n\n  if (self.uri.path) {\n    self.path = self.uri.path\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || '')\n  }\n\n  if (self.path.length === 0) {\n    self.path = '/'\n  }\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.aws) {\n    self.aws(options.aws)\n  }\n\n  if (options.hawk) {\n    self.hawk(options.hawk)\n  }\n\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature)\n  }\n\n  if (options.auth) {\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'username')) {\n      options.auth.user = options.auth.username\n    }\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'password')) {\n      options.auth.pass = options.auth.password\n    }\n\n    self.auth(\n      options.auth.user,\n      options.auth.pass,\n      options.auth.sendImmediately,\n      options.auth.bearer\n    )\n  }\n\n  if (self.gzip && !self.hasHeader('accept-encoding')) {\n    self.setHeader('accept-encoding', 'gzip, deflate')\n  }\n\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var uriAuthPieces = self.uri.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    self.auth(uriAuthPieces[0], uriAuthPieces.slice(1).join(':'), true)\n  }\n\n  if (!self.tunnel && self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization')) {\n    var proxyAuthPieces = self.proxy.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    var authHeader = 'Basic ' + toBase64(proxyAuthPieces.join(':'))\n    self.setHeader('proxy-authorization', authHeader)\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.path = (self.uri.protocol + '//' + self.uri.host + self.path)\n  }\n\n  if (options.json) {\n    self.json(options.json)\n  }\n  if (options.multipart) {\n    self.multipart(options.multipart)\n  }\n\n  if (options.time) {\n    self.timing = true\n    self.elapsedTime = self.elapsedTime || 0\n  }\n\n  function setContentLength () {\n    if (isTypedArray(self.body)) {\n      self.body = new Buffer(self.body)\n    }\n\n    if (!self.hasHeader('content-length')) {\n      var length\n      if (typeof self.body === 'string') {\n        length = Buffer.byteLength(self.body)\n      }\n      else if (Array.isArray(self.body)) {\n        length = self.body.reduce(function (a, b) {return a + b.length}, 0)\n      }\n      else {\n        length = self.body.length\n      }\n\n      if (length) {\n        self.setHeader('content-length', length)\n      } else {\n        self.emit('error', new Error('Argument error, options.body.'))\n      }\n    }\n  }\n  if (self.body && !isstream(self.body)) {\n    setContentLength()\n  }\n\n  if (options.oauth) {\n    self.oauth(options.oauth)\n  } else if (self._oauth.params && self.hasHeader('authorization')) {\n    self.oauth(self._oauth.params)\n  }\n\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol\n    , defaultModules = {'http:':http, 'https:':https}\n    , httpModules = self.httpModules || {}\n\n  self.httpModule = httpModules[protocol] || defaultModules[protocol]\n\n  if (!self.httpModule) {\n    return self.emit('error', new Error('Invalid protocol: ' + protocol))\n  }\n\n  if (options.ca) {\n    self.ca = options.ca\n  }\n\n  if (!self.agent) {\n    if (options.agentOptions) {\n      self.agentOptions = options.agentOptions\n    }\n\n    if (options.agentClass) {\n      self.agentClass = options.agentClass\n    } else if (options.forever) {\n      var v = version()\n      // use ForeverAgent in node 0.10- only\n      if (v.major === 0 && v.minor <= 10) {\n        self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL\n      } else {\n        self.agentClass = self.httpModule.Agent\n        self.agentOptions = self.agentOptions || {}\n        self.agentOptions.keepAlive = true\n      }\n    } else {\n      self.agentClass = self.httpModule.Agent\n    }\n  }\n\n  if (self.pool === false) {\n    self.agent = false\n  } else {\n    self.agent = self.agent || self.getNewAgent()\n  }\n\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) {\n      self.emit('error', new Error('You cannot pipe to this stream after the outbound request has started.'))\n    }\n    self.src = src\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', mime.lookup(src.path))\n      }\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i])\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error('You have already piped to this stream. Pipeing twice is likely to break the request.')\n    // })\n  })\n\n  defer(function () {\n    if (self._aborted) {\n      return\n    }\n\n    var end = function () {\n      if (self._form) {\n        if (!self._auth.hasAuth) {\n          self._form.pipe(self)\n        }\n        else if (self._auth.hasAuth && self._auth.sentAuth) {\n          self._form.pipe(self)\n        }\n      }\n      if (self._multipart && self._multipart.chunked) {\n        self._multipart.body.pipe(self)\n      }\n      if (self.body) {\n        if (isstream(self.body)) {\n          self.body.pipe(self)\n        } else {\n          setContentLength()\n          if (Array.isArray(self.body)) {\n            self.body.forEach(function (part) {\n              self.write(part)\n            })\n          } else {\n            self.write(self.body)\n          }\n          self.end()\n        }\n      } else if (self.requestBodyStream) {\n        console.warn('options.requestBodyStream is deprecated, please pass the request object to stream.pipe.')\n        self.requestBodyStream.pipe(self)\n      } else if (!self.src) {\n        if (self._auth.hasAuth && !self._auth.sentAuth) {\n          self.end()\n          return\n        }\n        if (self.method !== 'GET' && typeof self.method !== 'undefined') {\n          self.setHeader('content-length', 0)\n        }\n        self.end()\n      }\n    }\n\n    if (self._form && !self.hasHeader('content-length')) {\n      // Before ending the request, we had to compute the length of the whole form, asyncly\n      self.setHeader(self._form.getHeaders(), true)\n      self._form.getLength(function (err, length) {\n        if (!err && !isNaN(length)) {\n          self.setHeader('content-length', length)\n        }\n        end()\n      })\n    } else {\n      end()\n    }\n\n    self.ntick = true\n  })\n\n}\n\nRequest.prototype.getNewAgent = function () {\n  var self = this\n  var Agent = self.agentClass\n  var options = {}\n  if (self.agentOptions) {\n    for (var i in self.agentOptions) {\n      options[i] = self.agentOptions[i]\n    }\n  }\n  if (self.ca) {\n    options.ca = self.ca\n  }\n  if (self.ciphers) {\n    options.ciphers = self.ciphers\n  }\n  if (self.secureProtocol) {\n    options.secureProtocol = self.secureProtocol\n  }\n  if (self.secureOptions) {\n    options.secureOptions = self.secureOptions\n  }\n  if (typeof self.rejectUnauthorized !== 'undefined') {\n    options.rejectUnauthorized = self.rejectUnauthorized\n  }\n\n  if (self.cert && self.key) {\n    options.key = self.key\n    options.cert = self.cert\n  }\n\n  if (self.pfx) {\n    options.pfx = self.pfx\n  }\n\n  if (self.passphrase) {\n    options.passphrase = self.passphrase\n  }\n\n  var poolKey = ''\n\n  // different types of agents are in different pools\n  if (Agent !== self.httpModule.Agent) {\n    poolKey += Agent.name\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = self.proxy\n  if (typeof proxy === 'string') {\n    proxy = url.parse(proxy)\n  }\n  var isHttps = (proxy && proxy.protocol === 'https:') || this.uri.protocol === 'https:'\n\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ca\n    }\n\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.rejectUnauthorized\n    }\n\n    if (options.cert) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii')\n    }\n\n    if (options.pfx) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.pfx.toString('ascii')\n    }\n\n    if (options.ciphers) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ciphers\n    }\n\n    if (options.secureProtocol) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureProtocol\n    }\n\n    if (options.secureOptions) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureOptions\n    }\n  }\n\n  if (self.pool === globalPool && !poolKey && Object.keys(options).length === 0 && self.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return self.httpModule.globalAgent\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = self.uri.protocol + poolKey\n\n  // generate a new agent for this setting if none yet exists\n  if (!self.pool[poolKey]) {\n    self.pool[poolKey] = new Agent(options)\n    // properly set maxSockets on new agents\n    if (self.pool.maxSockets) {\n      self.pool[poolKey].maxSockets = self.pool.maxSockets\n    }\n  }\n\n  return self.pool[poolKey]\n}\n\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this\n\n  if (self._aborted) {\n    return\n  }\n\n  self._started = true\n  self.method = self.method || 'GET'\n  self.href = self.uri.href\n\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('content-length', self.src.stat.size)\n  }\n  if (self._aws) {\n    self.aws(self._aws, true)\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self)\n  delete reqOptions.auth\n\n  debug('make request', self.uri.href)\n\n  // node v6.8.0 now supports a `timeout` value in `http.request()`, but we\n  // should delete it for now since we handle timeouts manually for better\n  // consistency with node versions before v6.8.0\n  delete reqOptions.timeout\n\n  try {\n    self.req = self.httpModule.request(reqOptions)\n  } catch (err) {\n    self.emit('error', err)\n    return\n  }\n\n  if (self.timing) {\n    self.startTime = new Date().getTime()\n  }\n\n  var timeout\n  if (self.timeout && !self.timeoutTimer) {\n    if (self.timeout < 0) {\n      timeout = 0\n    } else if (typeof self.timeout === 'number' && isFinite(self.timeout)) {\n      timeout = self.timeout\n    }\n  }\n\n  self.req.on('response', self.onRequestResponse.bind(self))\n  self.req.on('error', self.onRequestError.bind(self))\n  self.req.on('drain', function() {\n    self.emit('drain')\n  })\n  self.req.on('socket', function(socket) {\n    var setReqTimeout = function() {\n      // This timeout sets the amount of time to wait *between* bytes sent\n      // from the server once connected.\n      //\n      // In particular, it's useful for erroring if the server fails to send\n      // data halfway through streaming a response.\n      self.req.setTimeout(timeout, function () {\n        if (self.req) {\n          self.abort()\n          var e = new Error('ESOCKETTIMEDOUT')\n          e.code = 'ESOCKETTIMEDOUT'\n          e.connect = false\n          self.emit('error', e)\n        }\n      })\n    }\n    // `._connecting` was the old property which was made public in node v6.1.0\n    var isConnecting = socket._connecting || socket.connecting\n    if (timeout !== undefined) {\n      // Only start the connection timer if we're actually connecting a new\n      // socket, otherwise if we're already connected (because this is a\n      // keep-alive connection) do not bother. This is important since we won't\n      // get a 'connect' event for an already connected socket.\n      if (isConnecting) {\n        var onReqSockConnect = function() {\n          socket.removeListener('connect', onReqSockConnect)\n          clearTimeout(self.timeoutTimer)\n          self.timeoutTimer = null\n          setReqTimeout()\n        }\n\n        socket.on('connect', onReqSockConnect)\n\n        self.req.on('error', function(err) {\n          socket.removeListener('connect', onReqSockConnect)\n        })\n\n        // Set a timeout in memory - this block will throw if the server takes more\n        // than `timeout` to write the HTTP status and headers (corresponding to\n        // the on('response') event on the client). NB: this measures wall-clock\n        // time, not the time between bytes sent by the server.\n        self.timeoutTimer = setTimeout(function () {\n          socket.removeListener('connect', onReqSockConnect)\n          self.abort()\n          var e = new Error('ETIMEDOUT')\n          e.code = 'ETIMEDOUT'\n          e.connect = true\n          self.emit('error', e)\n        }, timeout)\n      } else {\n        // We're already connected\n        setReqTimeout()\n      }\n    }\n    self.emit('socket', socket)\n  })\n\n  self.emit('request', self.req)\n}\n\nRequest.prototype.onRequestError = function (error) {\n  var self = this\n  if (self._aborted) {\n    return\n  }\n  if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET'\n      && self.agent.addRequestNoreuse) {\n    self.agent = { addRequest: self.agent.addRequestNoreuse.bind(self.agent) }\n    self.start()\n    self.req.end()\n    return\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n  self.emit('error', error)\n}\n\nRequest.prototype.onRequestResponse = function (response) {\n  var self = this\n  debug('onRequestResponse', self.uri.href, response.statusCode, response.headers)\n  response.on('end', function() {\n    if (self.timing) {\n      self.elapsedTime += (new Date().getTime() - self.startTime)\n      debug('elapsed time', self.elapsedTime)\n      response.elapsedTime = self.elapsedTime\n    }\n    debug('response end', self.uri.href, response.statusCode, response.headers)\n  })\n\n  if (self._aborted) {\n    debug('aborted', self.uri.href)\n    response.resume()\n    return\n  }\n\n  self.response = response\n  response.request = self\n  response.toJSON = responseToJSON\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https &&\n      self.strictSSL && (!response.hasOwnProperty('socket') ||\n      !response.socket.authorized)) {\n    debug('strict ssl error', self.uri.href)\n    var sslErr = response.hasOwnProperty('socket') ? response.socket.authorizationError : self.uri.href + ' does not support SSL'\n    self.emit('error', new Error('SSL Error: ' + sslErr))\n    return\n  }\n\n  // Save the original host before any redirect (if it changes, we need to\n  // remove any authorization headers).  Also remember the case of the header\n  // name because lots of broken servers expect Host instead of host and we\n  // want the caller to be able to specify this.\n  self.originalHost = self.getHeader('host')\n  if (!self.originalHostHeaderName) {\n    self.originalHostHeaderName = self.hasHeader('host')\n  }\n  if (self.setHost) {\n    self.removeHeader('host')\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n\n  var targetCookieJar = (self._jar && self._jar.setCookie) ? self._jar : globalCookieJar\n  var addCookie = function (cookie) {\n    //set the cookie if it's domain in the href's domain.\n    try {\n      targetCookieJar.setCookie(cookie, self.uri.href, {ignoreError: true})\n    } catch (e) {\n      self.emit('error', e)\n    }\n  }\n\n  response.caseless = caseless(response.headers)\n\n  if (response.caseless.has('set-cookie') && (!self._disableCookies)) {\n    var headerName = response.caseless.has('set-cookie')\n    if (Array.isArray(response.headers[headerName])) {\n      response.headers[headerName].forEach(addCookie)\n    } else {\n      addCookie(response.headers[headerName])\n    }\n  }\n\n  if (self._redirect.onResponse(response)) {\n    return // Ignore the rest of the response\n  } else {\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.on('close', function () {\n      if (!self._ended) {\n        self.response.emit('end')\n      }\n    })\n\n    response.once('end', function () {\n      self._ended = true\n    })\n\n    var noBody = function (code) {\n      return (\n        self.method === 'HEAD'\n        // Informational\n        || (code >= 100 && code < 200)\n        // No Content\n        || code === 204\n        // Not Modified\n        || code === 304\n      )\n    }\n\n    var responseContent\n    if (self.gzip && !noBody(response.statusCode)) {\n      var contentEncoding = response.headers['content-encoding'] || 'identity'\n      contentEncoding = contentEncoding.trim().toLowerCase()\n\n      if (contentEncoding === 'gzip') {\n        responseContent = zlib.createGunzip()\n        response.pipe(responseContent)\n      } else if (contentEncoding === 'deflate') {\n        responseContent = zlib.createInflate()\n        response.pipe(responseContent)\n      } else {\n        // Since previous versions didn't check for Content-Encoding header,\n        // ignore any invalid values to preserve backwards-compatibility\n        if (contentEncoding !== 'identity') {\n          debug('ignoring unrecognized Content-Encoding ' + contentEncoding)\n        }\n        responseContent = response\n      }\n    } else {\n      responseContent = response\n    }\n\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error('Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.')\n      } else if (responseContent.setEncoding) {\n        responseContent.setEncoding(self.encoding)\n      } else {\n        // Should only occur on node pre-v0.9.4 (joyent/node@9b5abe5) with\n        // zlib streams.\n        // If/When support for 0.9.4 is dropped, this should be unnecessary.\n        responseContent = responseContent.pipe(stringstream(self.encoding))\n      }\n    }\n\n    if (self._paused) {\n      responseContent.pause()\n    }\n\n    self.responseContent = responseContent\n\n    self.emit('response', response)\n\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest)\n    })\n\n    responseContent.on('data', function (chunk) {\n      if (self.timing && !self.responseStarted) {\n        self.responseStartTime = (new Date()).getTime()\n        response.responseStartTime = self.responseStartTime\n      }\n      self._destdata = true\n      self.emit('data', chunk)\n    })\n    responseContent.once('end', function (chunk) {\n      self.emit('end', chunk)\n    })\n    responseContent.on('error', function (error) {\n      self.emit('error', error)\n    })\n    responseContent.on('close', function () {self.emit('close')})\n\n    if (self.callback) {\n      self.readResponseBody(response)\n    }\n    //if no callback\n    else {\n      self.on('end', function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n        self.emit('complete', response)\n      })\n    }\n  }\n  debug('finish init function', self.uri.href)\n}\n\nRequest.prototype.readResponseBody = function (response) {\n  var self = this\n  debug('reading response\\'s body')\n  var buffers = []\n    , bufferLength = 0\n    , strings = []\n\n  self.on('data', function (chunk) {\n    if (!Buffer.isBuffer(chunk)) {\n      strings.push(chunk)\n    } else if (chunk.length) {\n      bufferLength += chunk.length\n      buffers.push(chunk)\n    }\n  })\n  self.on('end', function () {\n    debug('end event', self.uri.href)\n    if (self._aborted) {\n      debug('aborted', self.uri.href)\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n      return\n    }\n\n    if (bufferLength) {\n      debug('has body', self.uri.href, bufferLength)\n      response.body = Buffer.concat(buffers, bufferLength)\n      if (self.encoding !== null) {\n        response.body = response.body.toString(self.encoding)\n      }\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the Request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n    } else if (strings.length) {\n      // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n      // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n      if (self.encoding === 'utf8' && strings[0].length > 0 && strings[0][0] === '\\uFEFF') {\n        strings[0] = strings[0].substring(1)\n      }\n      response.body = strings.join('')\n    }\n\n    if (self._json) {\n      try {\n        response.body = JSON.parse(response.body, self._jsonReviver)\n      } catch (e) {\n        debug('invalid JSON received', self.uri.href)\n      }\n    }\n    debug('emitting complete', self.uri.href)\n    if (typeof response.body === 'undefined' && !self._json) {\n      response.body = self.encoding === null ? new Buffer(0) : ''\n    }\n    self.emit('complete', response, response.body)\n  })\n}\n\nRequest.prototype.abort = function () {\n  var self = this\n  self._aborted = true\n\n  if (self.req) {\n    self.req.abort()\n  }\n  else if (self.response) {\n    self.response.destroy()\n  }\n\n  self.emit('abort')\n}\n\nRequest.prototype.pipeDest = function (dest) {\n  var self = this\n  var response = self.response\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (response.caseless.has('content-type')) {\n      var ctname = response.caseless.has('content-type')\n      if (dest.setHeader) {\n        dest.setHeader(ctname, response.headers[ctname])\n      }\n      else {\n        dest.headers[ctname] = response.headers[ctname]\n      }\n    }\n\n    if (response.caseless.has('content-length')) {\n      var clname = response.caseless.has('content-length')\n      if (dest.setHeader) {\n        dest.setHeader(clname, response.headers[clname])\n      } else {\n        dest.headers[clname] = response.headers[clname]\n      }\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      // If the response content is being decoded, the Content-Encoding header\n      // of the response doesn't represent the piped content, so don't pass it.\n      if (!self.gzip || i !== 'content-encoding') {\n        dest.setHeader(i, response.headers[i])\n      }\n    }\n    dest.statusCode = response.statusCode\n  }\n  if (self.pipefilter) {\n    self.pipefilter(response, dest)\n  }\n}\n\nRequest.prototype.qs = function (q, clobber) {\n  var self = this\n  var base\n  if (!clobber && self.uri.query) {\n    base = self._qs.parse(self.uri.query)\n  } else {\n    base = {}\n  }\n\n  for (var i in q) {\n    base[i] = q[i]\n  }\n\n  var qs = self._qs.stringify(base)\n\n  if (qs === '') {\n    return self\n  }\n\n  self.uri = url.parse(self.uri.href.split('?')[0] + '?' + qs)\n  self.url = self.uri\n  self.path = self.uri.path\n\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  return self\n}\nRequest.prototype.form = function (form) {\n  var self = this\n  if (form) {\n    if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n      self.setHeader('content-type', 'application/x-www-form-urlencoded')\n    }\n    self.body = (typeof form === 'string')\n      ? self._qs.rfc3986(form.toString('utf8'))\n      : self._qs.stringify(form).toString('utf8')\n    return self\n  }\n  // create form-data object\n  self._form = new FormData()\n  self._form.on('error', function(err) {\n    err.message = 'form-data: ' + err.message\n    self.emit('error', err)\n    self.abort()\n  })\n  return self._form\n}\nRequest.prototype.multipart = function (multipart) {\n  var self = this\n\n  self._multipart.onRequest(multipart)\n\n  if (!self._multipart.chunked) {\n    self.body = self._multipart.body\n  }\n\n  return self\n}\nRequest.prototype.json = function (val) {\n  var self = this\n\n  if (!self.hasHeader('accept')) {\n    self.setHeader('accept', 'application/json')\n  }\n\n  if (typeof self.jsonReplacer === 'function') {\n    self._jsonReplacer = self.jsonReplacer\n  }\n\n  self._json = true\n  if (typeof val === 'boolean') {\n    if (self.body !== undefined) {\n      if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n        self.body = safeStringify(self.body, self._jsonReplacer)\n      } else {\n        self.body = self._qs.rfc3986(self.body)\n      }\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n    }\n  } else {\n    self.body = safeStringify(val, self._jsonReplacer)\n    if (!self.hasHeader('content-type')) {\n      self.setHeader('content-type', 'application/json')\n    }\n  }\n\n  if (typeof self.jsonReviver === 'function') {\n    self._jsonReviver = self.jsonReviver\n  }\n\n  return self\n}\nRequest.prototype.getHeader = function (name, headers) {\n  var self = this\n  var result, re, match\n  if (!headers) {\n    headers = self.headers\n  }\n  Object.keys(headers).forEach(function (key) {\n    if (key.length !== name.length) {\n      return\n    }\n    re = new RegExp(name, 'i')\n    match = key.match(re)\n    if (match) {\n      result = headers[key]\n    }\n  })\n  return result\n}\nRequest.prototype.enableUnixSocket = function () {\n  // Get the socket & request paths from the URL\n  var unixParts = this.uri.path.split(':')\n    , host = unixParts[0]\n    , path = unixParts[1]\n  // Apply unix properties to request\n  this.socketPath = host\n  this.uri.pathname = path\n  this.uri.path = path\n  this.uri.host = host\n  this.uri.hostname = host\n  this.uri.isUnix = true\n}\n\n\nRequest.prototype.auth = function (user, pass, sendImmediately, bearer) {\n  var self = this\n\n  self._auth.onRequest(user, pass, sendImmediately, bearer)\n\n  return self\n}\nRequest.prototype.aws = function (opts, now) {\n  var self = this\n\n  if (!now) {\n    self._aws = opts\n    return self\n  }\n\n  if (opts.sign_version == 4 || opts.sign_version == '4') {\n    // use aws4\n    var options = {\n      host: self.uri.host,\n      path: self.uri.path,\n      method: self.method,\n      headers: {\n        'content-type': self.getHeader('content-type') || ''\n      },\n      body: self.body\n    }\n    var signRes = aws4.sign(options, {\n      accessKeyId: opts.key,\n      secretAccessKey: opts.secret,\n      sessionToken: opts.session\n    })\n    self.setHeader('authorization', signRes.headers.Authorization)\n    self.setHeader('x-amz-date', signRes.headers['X-Amz-Date'])\n    if (signRes.headers['X-Amz-Security-Token']) {\n      self.setHeader('x-amz-security-token', signRes.headers['X-Amz-Security-Token'])\n    }\n  }\n  else {\n    // default: use aws-sign2\n    var date = new Date()\n    self.setHeader('date', date.toUTCString())\n    var auth =\n      { key: opts.key\n      , secret: opts.secret\n      , verb: self.method.toUpperCase()\n      , date: date\n      , contentType: self.getHeader('content-type') || ''\n      , md5: self.getHeader('content-md5') || ''\n      , amazonHeaders: aws2.canonicalizeHeaders(self.headers)\n      }\n    var path = self.uri.path\n    if (opts.bucket && path) {\n      auth.resource = '/' + opts.bucket + path\n    } else if (opts.bucket && !path) {\n      auth.resource = '/' + opts.bucket\n    } else if (!opts.bucket && path) {\n      auth.resource = path\n    } else if (!opts.bucket && !path) {\n      auth.resource = '/'\n    }\n    auth.resource = aws2.canonicalizeResource(auth.resource)\n    self.setHeader('authorization', aws2.authorization(auth))\n  }\n\n  return self\n}\nRequest.prototype.httpSignature = function (opts) {\n  var self = this\n  httpSignature.signRequest({\n    getHeader: function(header) {\n      return self.getHeader(header, self.headers)\n    },\n    setHeader: function(header, value) {\n      self.setHeader(header, value)\n    },\n    method: self.method,\n    path: self.path\n  }, opts)\n  debug('httpSignature authorization', self.getHeader('authorization'))\n\n  return self\n}\nRequest.prototype.hawk = function (opts) {\n  var self = this\n  self.setHeader('Authorization', hawk.client.header(self.uri, self.method, opts).field)\n}\nRequest.prototype.oauth = function (_oauth) {\n  var self = this\n\n  self._oauth.onRequest(_oauth)\n\n  return self\n}\n\nRequest.prototype.jar = function (jar) {\n  var self = this\n  var cookies\n\n  if (self._redirect.redirectsFollowed === 0) {\n    self.originalCookieHeader = self.getHeader('cookie')\n  }\n\n  if (!jar) {\n    // disable cookies\n    cookies = false\n    self._disableCookies = true\n  } else {\n    var targetCookieJar = (jar && jar.getCookieString) ? jar : globalCookieJar\n    var urihref = self.uri.href\n    //fetch cookie in the Specified host\n    if (targetCookieJar) {\n      cookies = targetCookieJar.getCookieString(urihref)\n    }\n  }\n\n  //if need cookie and cookie is not empty\n  if (cookies && cookies.length) {\n    if (self.originalCookieHeader) {\n      // Don't overwrite existing Cookie header\n      self.setHeader('cookie', self.originalCookieHeader + '; ' + cookies)\n    } else {\n      self.setHeader('cookie', cookies)\n    }\n  }\n  self._jar = jar\n  return self\n}\n\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  var self = this\n\n  if (self.response) {\n    if (self._destdata) {\n      self.emit('error', new Error('You cannot pipe after data has been emitted from the response.'))\n    } else if (self._ended) {\n      self.emit('error', new Error('You cannot pipe after the response has been ended.'))\n    } else {\n      stream.Stream.prototype.pipe.call(self, dest, opts)\n      self.pipeDest(dest)\n      return dest\n    }\n  } else {\n    self.dests.push(dest)\n    stream.Stream.prototype.pipe.call(self, dest, opts)\n    return dest\n  }\n}\nRequest.prototype.write = function () {\n  var self = this\n  if (self._aborted) {return}\n\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    return self.req.write.apply(self.req, arguments)\n  }\n}\nRequest.prototype.end = function (chunk) {\n  var self = this\n  if (self._aborted) {return}\n\n  if (chunk) {\n    self.write(chunk)\n  }\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    self.req.end()\n  }\n}\nRequest.prototype.pause = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = true\n  } else {\n    self.responseContent.pause.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.resume = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = false\n  } else {\n    self.responseContent.resume.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.destroy = function () {\n  var self = this\n  if (!self._ended) {\n    self.end()\n  } else if (self.response) {\n    self.response.destroy()\n  }\n}\n\nRequest.defaultProxyHeaderWhiteList =\n  Tunnel.defaultProxyHeaderWhiteList.slice()\n\nRequest.defaultProxyHeaderExclusiveList =\n  Tunnel.defaultProxyHeaderExclusiveList.slice()\n\n// Exports\n\nRequest.prototype.toJSON = requestToJSON\nmodule.exports = Request\n"]}
{"version":3,"sources":["eddsa.js"],"names":[],"mappings":"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","file":"eddsa-compiled.js","sourcesContent":["\"use strict\";\n/**\n * @fileOverview\n * Digital signature scheme based on Curve25519 (Ed25519 or EdDSA).\n */\n\n/*\n * Copyright (c) 2011, 2012, 2014 Ron Garret\n * Copyright (c) 2014 Mega Limited\n * under the MIT License.\n *\n * Authors: Guy K. Kloss, Ron Garret\n *\n * You should have received a copy of the license along with this program.\n */\n\nvar core = require('./core');\nvar curve255 = require('./curve255');\nvar utils = require('./utils');\nvar BigInteger = require('jsbn').BigInteger;\nvar crypto = require('crypto');\n\n    /**\n     * @exports jodid25519/eddsa\n     * Digital signature scheme based on Curve25519 (Ed25519 or EdDSA).\n     *\n     * @description\n     * Digital signature scheme based on Curve25519 (Ed25519 or EdDSA).\n     *\n     * <p>\n     * This code is adapted from fast-djbec.js, a faster but more complicated\n     * version of the Ed25519 encryption scheme (as compared to djbec.js).\n     * It uses two different representations for big integers: The jsbn\n     * BigInteger class, which can represent arbitrary-length numbers, and a\n     * special fixed-length representation optimised for 256-bit integers.\n     * The reason both are needed is that the Ed25519 algorithm requires some\n     * 512-bit numbers.</p>\n    */\n    var ns = {};\n\n    function _bi255(value) {\n        if (!(this instanceof _bi255)) {\n            return new _bi255(value);\n        }\n        if (typeof value === 'undefined') {\n            return _ZERO;\n        }\n        var c = value.constructor;\n        if ((c === Array || c === Uint16Array || c === Uint32Array) && (value.length === 16)) {\n            this.n = value;\n        } else if ((c === Array) && (value.length === 32)) {\n            this.n = _bytes2bi255(value).n;\n        } else if (c === String) {\n            this.n = utils.hexDecode(value);\n        } else if (c === Number) {\n            this.n = [value & 0xffff,\n                      value >> 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        } else if (value instanceof _bi255) {\n            this.n = value.n.slice(0); // Copy constructor\n        } else {\n            throw \"Bad argument for bignum: \" + value;\n        }\n    }\n\n   _bi255.prototype = {\n        'toString' : function() {\n            return utils.hexEncode(this.n);\n        },\n        'toSource' : function() {\n            return '_' + utils.hexEncode(this.n);\n        },\n        'plus' : function(n1) {\n            return _bi255(core.bigintadd(this.n, n1.n));\n        },\n        'minus' : function(n1) {\n            return _bi255(core.bigintsub(this.n, n1.n)).modq();\n        },\n        'times' : function(n1) {\n            return _bi255(core.mulmodp(this.n, n1.n));\n        },\n        'divide' : function(n1) {\n            return this.times(n1.inv());\n        },\n        'sqr' : function() {\n            return _bi255(core.sqrmodp(this.n));\n        },\n        'cmp' : function(n1) {\n            return core.bigintcmp(this.n, n1.n);\n        },\n        'equals' : function(n1) {\n            return this.cmp(n1) === 0;\n        },\n        'isOdd' : function() {\n            return (this.n[0] & 1) === 1;\n        },\n        'shiftLeft' : function(cnt) {\n            _shiftL(this.n, cnt);\n            return this;\n        },\n        'shiftRight' : function(cnt) {\n            _shiftR(this.n, cnt);\n            return this;\n        },\n        'inv' : function() {\n            return _bi255(core.invmodp(this.n));\n        },\n        'pow' : function(e) {\n            return _bi255(_pow(this.n, e.n));\n        },\n        'modq' : function() {\n            return _modq(this);\n        },\n        'bytes' : function() {\n            return _bi255_bytes(this);\n        }\n    };\n\n    function _shiftL(n, cnt) {\n        var lastcarry = 0;\n        for (var i = 0; i < 16; i++) {\n            var carry = n[i] >> (16 - cnt);\n            n[i] = (n[i] << cnt) & 0xffff | lastcarry;\n            lastcarry = carry;\n        }\n        return n;\n    }\n\n    function _shiftR(n, cnt) {\n        var lastcarry = 0;\n        for (var i = 15; i >= 0; i--) {\n            var carry = n[i] << (16 - cnt) & 0xffff;\n            n[i] = (n[i] >> cnt) | lastcarry;\n            lastcarry = carry;\n        }\n        return n;\n    }\n\n    function _bi255_bytes(n) {\n        n = _bi255(n); // Make a copy because shiftRight is destructive\n        var a = new Array(32);\n        for (var i = 31; i >= 0; i--) {\n            a[i] = n.n[0] & 0xff;\n            n.shiftRight(8);\n        }\n        return a;\n    }\n\n    function _bytes2bi255(a) {\n        var n = _ZERO;\n        for (var i = 0; i < 32; i++) {\n            n.shiftLeft(8);\n            n = n.plus(_bi255(a[i]));\n        }\n        return n;\n    }\n\n    function _pow(n, e) {\n        var result = core.ONE();\n        for (var i = 0; i < 256; i++) {\n            if (core.getbit(e, i) === 1) {\n                result = core.mulmodp(result, n);\n            }\n            n = core.sqrmodp(n);\n        }\n        return result;\n    }\n\n    var _ZERO = _bi255(0);\n    var _ONE = _bi255(1);\n    var _TWO = _bi255(2);\n    // This is the core prime.\n    var _Q = _bi255([0xffff - 18, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,\n                     0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,\n                     0xffff, 0xffff, 0x7fff]);\n\n    function _modq(n) {\n        core.reduce(n.n);\n        if (n.cmp(_Q) >= 0) {\n            return _modq(n.minus(_Q));\n        }\n        if (n.cmp(_ZERO) === -1) {\n            return _modq(n.plus(_Q));\n        } else {\n            return n;\n        }\n    }\n\n    // _RECOVERY_EXPONENT = _Q.plus(_bi255(3)).divide(_bi255(8));\n    var _RECOVERY_EXPONENT = _bi255('0ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe');\n    // _D = _Q.minus(_bi255(121665)).divide(_bi255(121666));\n    var _D = _bi255('52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3');\n    // _I = _TWO.pow(_Q.minus(_ONE).divide(_bi255(4)));\n    var _I = _bi255('2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0');\n    // _L = _TWO.pow(_bi255(252)).plus(_bi255('14def9dea2f79cd65812631a5cf5d3ed'));\n    var _L = _bi255('1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed');\n    var _L_BI = _bi('1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed', 16);\n\n\n    // ////////////////////////////////////////////////////////////\n\n    function _isoncurve(p) {\n        var x = p[0];\n        var y = p[1];\n        var xsqr = x.sqr();\n        var ysqr = y.sqr();\n        var v = _D.times(xsqr).times(ysqr);\n        return ysqr.minus(xsqr).minus(_ONE).minus(v).modq().equals(_ZERO);\n    }\n\n    function _xrecover(y) {\n        var ysquared = y.sqr();\n        var xx = ysquared.minus(_ONE).divide(_ONE.plus(_D.times(ysquared)));\n        var x = xx.pow(_RECOVERY_EXPONENT);\n        if (!(x.times(x).minus(xx).equals(_ZERO))) {\n            x = x.times(_I);\n        }\n        if (x.isOdd()) {\n            x = _Q.minus(x);\n        }\n        return x;\n    }\n\n    function _x_pt_add(pt1, pt2) {\n        var x1 = pt1[0];\n        var y1 = pt1[1];\n        var z1 = pt1[2];\n        var t1 = pt1[3];\n        var x2 = pt2[0];\n        var y2 = pt2[1];\n        var z2 = pt2[2];\n        var t2 = pt2[3];\n        var A = y1.minus(x1).times(y2.plus(x2));\n        var B = y1.plus(x1).times(y2.minus(x2));\n        var C = z1.times(_TWO).times(t2);\n        var D = t1.times(_TWO).times(z2);\n        var E = D.plus(C);\n        var F = B.minus(A);\n        var G = B.plus(A);\n        var H = D.minus(C);\n        return [E.times(F), G.times(H), F.times(G), E.times(H)];\n    }\n\n    function _xpt_double(pt1) {\n        var x1 = pt1[0];\n        var y1 = pt1[1];\n        var z1 = pt1[2];\n        var A = x1.times(x1);\n        var B = y1.times(y1);\n        var C = _TWO.times(z1).times(z1);\n        var D = _Q.minus(A);\n        var J = x1.plus(y1);\n        var E = J.times(J).minus(A).minus(B);\n        var G = D.plus(B);\n        var F = G.minus(C);\n        var H = D.minus(B);\n        return [E.times(F), G.times(H), F.times(G), E.times(H)];\n    }\n\n    function _xpt_mult(pt, n) {\n        if (n.equals(_ZERO)) {\n            return [_ZERO, _ONE, _ONE, _ZERO];\n        }\n        var odd = n.isOdd();\n        n.shiftRight(1);\n        var value = _xpt_double(_xpt_mult(pt, n));\n        return odd ? _x_pt_add(value, pt) : value;\n    }\n\n    function _pt_xform(pt) {\n        var x = pt[0];\n        var y = pt[1];\n        return [x, y, _ONE, x.times(y)];\n    }\n\n    function _pt_unxform(pt) {\n        var x = pt[0];\n        var y = pt[1];\n        var z = pt[2];\n        var invz = z.inv();\n        return [x.times(invz), y.times(invz)];\n    }\n\n    function _scalarmult(pt, n) {\n        return _pt_unxform(_xpt_mult(_pt_xform(pt), n));\n    }\n\n    function _bytesgetbit(bytes, n) {\n        return (bytes[bytes.length - (n >>> 3) - 1] >> (n & 7)) & 1;\n    }\n\n    function _xpt_mult_bytes(pt, bytes) {\n        var r = [_ZERO, _ONE, _ONE, _ZERO];\n        for (var i = (bytes.length << 3) - 1; i >= 0; i--) {\n            r = _xpt_double(r);\n            if (_bytesgetbit(bytes, i) === 1) {\n                r = _x_pt_add(r, pt);\n            }\n        }\n        return r;\n    }\n\n    function _scalarmultBytes(pt, bytes) {\n        return _pt_unxform(_xpt_mult_bytes(_pt_xform(pt), bytes));\n    }\n\n    var _by = _bi255(4).divide(_bi255(5));\n    var _bx = _xrecover(_by);\n    var _bp = [_bx, _by];\n\n    function _encodeint(n) {\n        return n.bytes(32).reverse();\n    }\n    function _decodeint(b) {\n        return _bi255(b.slice(0).reverse());\n    }\n\n    function _encodepoint(p) {\n        var v = _encodeint(p[1]);\n        if (p[0].isOdd()) {\n            v[31] |= 0x80;\n        }\n        return v;\n    }\n\n    function _decodepoint(v) {\n        v = v.slice(0);\n        var signbit = v[31] >> 7;\n        v[31] &= 127;\n        var y = _decodeint(v);\n        var x = _xrecover(y);\n        if ((x.n[0] & 1) !== signbit) {\n            x = _Q.minus(x);\n        }\n        var p = [x, y];\n        if (!_isoncurve(p)) {\n            throw ('Point is not on curve');\n        }\n        return p;\n    }\n\n    // //////////////////////////////////////////////////\n\n    /**\n     * Factory function to create a suitable BigInteger.\n     *\n     * @param value\n     *     The value for the big integer.\n     * @param base {integer}\n     *     Base of the conversion of elements in ``value``.\n     * @returns\n     *     A BigInteger object.\n     */\n    function _bi(value, base) {\n        if (base !== undefined) {\n            if (base === 256) {\n                return _bi(utils.string2bytes(value));\n            }\n            return new BigInteger(value, base);\n        } else if (typeof value === 'string') {\n            return new BigInteger(value, 10);\n        } else if ((value instanceof Array) || (value instanceof Uint8Array)\n          || Buffer.isBuffer(value)) {\n            return new BigInteger(value);\n        } else if (typeof value === 'number') {\n            return new BigInteger(value.toString(), 10);\n        } else {\n            throw \"Can't convert \" + value + \" to BigInteger\";\n        }\n    }\n\n    function _bi2bytes(n, cnt) {\n        if (cnt === undefined) {\n            cnt = (n.bitLength() + 7) >>> 3;\n        }\n        var bytes = new Array(cnt);\n        for (var i = cnt - 1; i >= 0; i--) {\n            bytes[i] = n[0] & 255; // n.and(0xff);\n            n = n.shiftRight(8);\n        }\n        return bytes;\n    }\n\n    BigInteger.prototype.bytes = function(n) {\n        return _bi2bytes(this, n);\n    };\n\n    // /////////////////////////////////////////////////////////\n\n    function _bytehash(s) {\n        var sha = crypto.createHash('sha512').update(s).digest();\n        return _bi2bytes(_bi(sha), 64).reverse();\n    }\n\n    function _stringhash(s) {\n        var sha = crypto.createHash('sha512').update(s).digest();\n        return _map(_chr, _bi2bytes(_bi(sha), 64)).join('');\n    }\n\n    function _inthash(s) {\n        // Need a leading 0 to prevent sign extension\n        return _bi([0].concat(_bytehash(s)));\n    }\n\n    function _inthash_lo(s) {\n        return _bi255(_bytehash(s).slice(32, 64));\n    }\n\n    function _inthash_mod_l(s) {\n        return _inthash(s).mod(_L_BI);\n    }\n\n    function _get_a(sk) {\n        var a = _inthash_lo(sk);\n        a.n[0] &= 0xfff8;\n        a.n[15] &= 0x3fff;\n        a.n[15] |= 0x4000;\n        return a;\n    }\n\n    function _publickey(sk) {\n        return _encodepoint(_scalarmult(_bp, _get_a(sk)));\n    }\n\n    function _map(f, l) {\n        var result = new Array(l.length);\n        for (var i = 0; i < l.length; i++) {\n            result[i] = f(l[i]);\n        }\n        return result;\n    }\n\n    function _chr(n) {\n        return String.fromCharCode(n);\n    }\n\n    function _ord(c) {\n        return c.charCodeAt(0);\n    }\n\n    function _pt_add(p1, p2) {\n        return _pt_unxform(_x_pt_add(_pt_xform(p1), _pt_xform(p2)));\n    }\n\n\n    // Exports for the API.\n\n    /**\n     * Checks whether a point is on the curve.\n     *\n     * @function\n     * @param point {string}\n     *     The point to check for in a byte string representation.\n     * @returns {boolean}\n     *     true if the point is on the curve, false otherwise.\n     */\n    ns.isOnCurve = function(point) {\n        try {\n            _isoncurve(_decodepoint(utils.string2bytes(point)));\n        } catch(e) {\n            if (e === 'Point is not on curve') {\n                return false;\n            } else {\n                throw e;\n            }\n        }\n        return true;\n    };\n\n\n    /**\n     * Computes the EdDSA public key.\n     *\n     * <p>Note: Seeds should be a byte string, not a unicode string containing\n     * multi-byte characters.</p>\n     *\n     * @function\n     * @param keySeed {string}\n     *     Private key seed in the form of a byte string.\n     * @returns {string}\n     *     Public key as byte string computed from the private key seed\n     *     (32 bytes).\n     */\n    ns.publicKey = function(keySeed) {\n        return utils.bytes2string(_publickey(keySeed));\n    };\n\n\n    /**\n     * Computes an EdDSA signature of a message.\n     *\n     * <p>Notes:</p>\n     *\n     * <ul>\n     *   <li>Unicode messages need to be converted to a byte representation\n     *   (e. g. UTF-8).</li>\n     *   <li>If `publicKey` is given, and it is *not* a point of the curve,\n     *   the signature will be faulty, but no error will be thrown.</li>\n     * </ul>\n     *\n     * @function\n     * @param message {string}\n     *     Message in the form of a byte string.\n     * @param keySeed {string}\n     *     Private key seed in the form of a byte string.\n     * @param publicKey {string}\n     *     Public key as byte string (if not present, it will be computed from\n     *     the private key seed).\n     * @returns {string}\n     *     Detached message signature in the form of a byte string (64 bytes).\n     */\n    ns.sign = function(message, keySeed, publicKey) {\n        if (publicKey === undefined) {\n            publicKey = _publickey(keySeed);\n        } else {\n            publicKey = utils.string2bytes(publicKey);\n        }\n        var a = _bi(_get_a(keySeed).toString(), 16);\n        var hs = _stringhash(keySeed);\n        var r = _bytehash(hs.slice(32, 64) + message);\n        var rp = _scalarmultBytes(_bp, r);\n        var erp = _encodepoint(rp);\n        r = _bi(r).mod(_bi(1, 10).shiftLeft(512));\n        var s = _map(_chr, erp).join('') + _map(_chr, publicKey).join('') + message;\n        s = _inthash_mod_l(s).multiply(a).add(r).mod(_L_BI);\n        return utils.bytes2string(erp.concat(_encodeint(s)));\n    };\n\n\n    /**\n     * Verifies an EdDSA signature of a message with the public key.\n     *\n     * <p>Note: Unicode messages need to be converted to a byte representation\n     * (e. g. UTF-8).</p>\n     *\n     * @function\n     * @param signature {string}\n     *     Message signature in the form of a byte string. Can be detached\n     *     (64 bytes), or attached to be sliced off.\n     * @param message {string}\n     *     Message in the form of a byte string.\n     * @param publicKey {string}\n     *     Public key as byte string (if not present, it will be computed from\n     *     the private key seed).\n     * @returns {boolean}\n     *     true, if the signature verifies.\n     */\n    ns.verify = function(signature, message, publicKey) {\n        signature = utils.string2bytes(signature.slice(0, 64));\n        publicKey = utils.string2bytes(publicKey);\n        var rpe = signature.slice(0, 32);\n        var rp = _decodepoint(rpe);\n        var a = _decodepoint(publicKey);\n        var s = _decodeint(signature.slice(32, 64));\n        var h = _inthash(utils.bytes2string(rpe.concat(publicKey)) + message);\n        var v1 = _scalarmult(_bp, s);\n        var value = _scalarmultBytes(a, _bi2bytes(h));\n        var v2 = _pt_add(rp, value);\n        return v1[0].equals(v2[0]) && v1[1].equals(v2[1]);\n    };\n\n\n    /**\n     * Generates a new random private key seed of 32 bytes length (256 bit).\n     *\n     * @function\n     * @returns {string}\n     *     Byte string containing a new random private key seed.\n     */\n    ns.generateKeySeed = function() {\n        return core.generateKey(false);\n    };\n\nmodule.exports = ns;\n"]}
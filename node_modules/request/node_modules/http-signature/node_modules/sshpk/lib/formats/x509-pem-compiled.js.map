{"version":3,"sources":["x509-pem.js"],"names":[],"mappings":";;AAEA,IAAI,OAAO,QAAQ,QAAR,CAAX;;AAEA,OAAO,OAAP,GAAiB;AAChB,OAAM,IADU;AAEhB,SAAQ,KAAK,MAFG;AAGhB,OAAM,KAAK,IAHK;AAIhB,QAAO;AAJS,CAAjB;;AAOA,IAAI,SAAS,QAAQ,aAAR,CAAb;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,OAAO,QAAQ,SAAR,CAAX;AACA,IAAI,QAAQ,QAAQ,UAAR,CAAZ;AACA,IAAI,MAAM,QAAQ,QAAR,CAAV;AACA,IAAI,aAAa,QAAQ,gBAAR,CAAjB;AACA,IAAI,MAAM,QAAQ,OAAR,CAAV;AACA,IAAI,WAAW,QAAQ,aAAR,CAAf;AACA,IAAI,YAAY,QAAQ,cAAR,CAAhB;AACA,IAAI,cAAc,QAAQ,gBAAR,CAAlB;;AAEA,SAAS,IAAT,CAAc,GAAd,EAAmB,OAAnB,EAA4B;AAC3B,KAAI,OAAQ,GAAR,KAAiB,QAArB,EAA+B;AAC9B,SAAO,MAAP,CAAc,GAAd,EAAmB,KAAnB;AACA,QAAM,IAAI,QAAJ,CAAa,OAAb,CAAN;AACA;;AAED,KAAI,QAAQ,IAAI,IAAJ,GAAW,KAAX,CAAiB,UAAjB,CAAZ;;AAEA,KAAI,IAAI,MAAM,CAAN,EAAS,KAAT,C;AACJ,oCADI,CAAR;AAEA,QAAO,EAAP,CAAU,CAAV,EAAa,oBAAb;;AAEA,KAAI,KAAK,MAAM,MAAM,MAAN,GAAe,CAArB,EAAwB,KAAxB,C;AACL,kCADK,CAAT;AAEA,QAAO,EAAP,CAAU,EAAV,EAAc,oBAAd;;AAEA,KAAI,UAAU,EAAd;AACA,QAAO,IAAP,EAAa;AACZ,UAAQ,MAAM,KAAN,CAAY,CAAZ,CAAR;AACA,MAAI,MAAM,CAAN,EAAS,KAAT,C;AACA,2BADA,CAAJ;AAEA,MAAI,CAAC,CAAL,EACC;AACD,UAAQ,EAAE,CAAF,EAAK,WAAL,EAAR,IAA8B,EAAE,CAAF,CAA9B;AACA;;;AAGD,SAAQ,MAAM,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,EAAmB,IAAnB,CAAwB,EAAxB,CAAR;AACA,OAAM,IAAI,MAAJ,CAAW,KAAX,EAAkB,QAAlB,CAAN;;AAEA,QAAQ,KAAK,IAAL,CAAU,GAAV,EAAe,OAAf,CAAR;AACA;;AAED,SAAS,KAAT,CAAe,IAAf,EAAqB,OAArB,EAA8B;AAC7B,KAAI,OAAO,KAAK,KAAL,CAAW,IAAX,EAAiB,OAAjB,CAAX;;AAEA,KAAI,SAAS,aAAb;AACA,KAAI,MAAM,KAAK,QAAL,CAAc,QAAd,CAAV;AACA,KAAI,MAAM,IAAI,MAAJ,GAAc,IAAI,MAAJ,GAAa,EAA3B,GACN,EADM,GACD,EADC,GACI,OAAO,MAAP,GAAc,CADlB,GACsB,EADhC;AAEA,KAAI,MAAM,IAAI,MAAJ,CAAW,GAAX,CAAV;AACA,KAAI,IAAI,CAAR;AACA,MAAK,IAAI,KAAJ,CAAU,gBAAgB,MAAhB,GAAyB,SAAnC,EAA8C,CAA9C,CAAL;AACA,MAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,IAAI,MAAxB,GAAkC;AACjC,MAAI,QAAQ,IAAI,EAAhB;AACA,MAAI,QAAQ,IAAI,MAAhB,EACC,QAAQ,IAAI,MAAZ;AACD,OAAK,IAAI,KAAJ,CAAU,IAAI,KAAJ,CAAU,CAAV,EAAa,KAAb,CAAV,EAA+B,CAA/B,CAAL;AACA,MAAI,GAAJ,IAAW,EAAX;AACA,MAAI,KAAJ;AACA;AACD,MAAK,IAAI,KAAJ,CAAU,cAAc,MAAd,GAAuB,SAAjC,EAA4C,CAA5C,CAAL;;AAEA,QAAQ,IAAI,KAAJ,CAAU,CAAV,EAAa,CAAb,CAAR;AACA","file":"x509-pem-compiled.js","sourcesContent":["// Copyright 2016 Joyent, Inc.\n\nvar x509 = require('./x509');\n\nmodule.exports = {\n\tread: read,\n\tverify: x509.verify,\n\tsign: x509.sign,\n\twrite: write\n};\n\nvar assert = require('assert-plus');\nvar asn1 = require('asn1');\nvar algs = require('../algs');\nvar utils = require('../utils');\nvar Key = require('../key');\nvar PrivateKey = require('../private-key');\nvar pem = require('./pem');\nvar Identity = require('../identity');\nvar Signature = require('../signature');\nvar Certificate = require('../certificate');\n\nfunction read(buf, options) {\n\tif (typeof (buf) !== 'string') {\n\t\tassert.buffer(buf, 'buf');\n\t\tbuf = buf.toString('ascii');\n\t}\n\n\tvar lines = buf.trim().split(/[\\r\\n]+/g);\n\n\tvar m = lines[0].match(/*JSSTYLED*/\n\t    /[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);\n\tassert.ok(m, 'invalid PEM header');\n\n\tvar m2 = lines[lines.length - 1].match(/*JSSTYLED*/\n\t    /[-]+[ ]*END CERTIFICATE[ ]*[-]+/);\n\tassert.ok(m2, 'invalid PEM footer');\n\n\tvar headers = {};\n\twhile (true) {\n\t\tlines = lines.slice(1);\n\t\tm = lines[0].match(/*JSSTYLED*/\n\t\t    /^([A-Za-z0-9-]+): (.+)$/);\n\t\tif (!m)\n\t\t\tbreak;\n\t\theaders[m[1].toLowerCase()] = m[2];\n\t}\n\n\t/* Chop off the first and last lines */\n\tlines = lines.slice(0, -1).join('');\n\tbuf = new Buffer(lines, 'base64');\n\n\treturn (x509.read(buf, options));\n}\n\nfunction write(cert, options) {\n\tvar dbuf = x509.write(cert, options);\n\n\tvar header = 'CERTIFICATE';\n\tvar tmp = dbuf.toString('base64');\n\tvar len = tmp.length + (tmp.length / 64) +\n\t    18 + 16 + header.length*2 + 10;\n\tvar buf = new Buffer(len);\n\tvar o = 0;\n\to += buf.write('-----BEGIN ' + header + '-----\\n', o);\n\tfor (var i = 0; i < tmp.length; ) {\n\t\tvar limit = i + 64;\n\t\tif (limit > tmp.length)\n\t\t\tlimit = tmp.length;\n\t\to += buf.write(tmp.slice(i, limit), o);\n\t\tbuf[o++] = 10;\n\t\ti = limit;\n\t}\n\to += buf.write('-----END ' + header + '-----\\n', o);\n\n\treturn (buf.slice(0, o));\n}\n"]}
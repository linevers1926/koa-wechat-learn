{"version":3,"sources":["index.js"],"names":[],"mappings":";;AAEA,IAAI,SAAS,QAAQ,QAAR,CAAb;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;;;;AAKA,IAAI,YAAY,EAAhB;;;;AAKA,QAAQ,YAAR,GAAuB,UAAU,IAAV,EAAgB;;AAEnC,QAAI,SAAS,QAAQ,UAAR,CAAmB,CAAC,OAAO,CAAR,IAAa,CAAhC,CAAb;AACA,QAAI,kBAAkB,KAAtB,EAA6B;AACzB,eAAO,MAAP;AACH;;AAED,QAAI,SAAS,OAAO,QAAP,CAAgB,QAAhB,EAA0B,OAA1B,CAAkC,KAAlC,EAAyC,GAAzC,EAA8C,OAA9C,CAAsD,KAAtD,EAA6D,GAA7D,EAAkE,OAAlE,CAA0E,KAA1E,EAAiF,EAAjF,CAAb;AACA,WAAO,OAAO,KAAP,CAAa,CAAb,EAAgB,IAAhB,CAAP;AACH,CATD;;AAYA,QAAQ,UAAR,GAAqB,UAAU,IAAV,EAAgB;;AAEjC,QAAI,CAAC,IAAD,IACA,OAAO,CADX,EACc;;AAEV,eAAO,KAAK,QAAL,CAAc,2BAAd,CAAP;AACH;;AAED,QAAI,QAAQ,KAAK,IAAL,CAAU,OAAO,CAAjB,CAAZ;AACA,QAAI;AACA,eAAO,OAAO,WAAP,CAAmB,KAAnB,CAAP;AACH,KAFD,CAGA,OAAO,GAAP,EAAY;AACR,eAAO,KAAK,QAAL,CAAc,oCAAoC,IAAI,OAAtD,CAAP;AACH;AACJ,CAfD;;;;AAoBA,QAAQ,mBAAR,GAA8B,UAAU,CAAV,EAAa,CAAb,EAAgB;;AAE1C,QAAI,OAAO,CAAP,KAAa,QAAb,IACA,OAAO,CAAP,KAAa,QADjB,EAC2B;;AAEvB,eAAO,KAAP;AACH;;AAED,QAAI,WAAY,EAAE,MAAF,KAAa,EAAE,MAAf,GAAwB,CAAxB,GAA4B,CAA5C;AACA,QAAI,QAAJ,EAAc;AACV,YAAI,CAAJ;AACH;;AAED,SAAK,IAAI,IAAI,CAAR,EAAW,KAAK,EAAE,MAAvB,EAA+B,IAAI,EAAnC,EAAuC,EAAE,CAAzC,EAA4C;AACxC,YAAI,KAAK,EAAE,UAAF,CAAa,CAAb,CAAT;AACA,YAAI,KAAK,EAAE,UAAF,CAAa,CAAb,CAAT;AACA,oBAAa,KAAK,EAAlB;AACH;;AAED,WAAQ,aAAa,CAArB;AACH,CApBD","file":"index-compiled.js","sourcesContent":["// Load modules\n\nvar Crypto = require('crypto');\nvar Boom = require('boom');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Generate a cryptographically strong pseudo-random data\n\nexports.randomString = function (size) {\n\n    var buffer = exports.randomBits((size + 1) * 6);\n    if (buffer instanceof Error) {\n        return buffer;\n    }\n\n    var string = buffer.toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n    return string.slice(0, size);\n};\n\n\nexports.randomBits = function (bits) {\n\n    if (!bits ||\n        bits < 0) {\n\n        return Boom.internal('Invalid random bits count');\n    }\n\n    var bytes = Math.ceil(bits / 8);\n    try {\n        return Crypto.randomBytes(bytes);\n    }\n    catch (err) {\n        return Boom.internal('Failed generating random bits: ' + err.message);\n    }\n};\n\n\n// Compare two strings using fixed time algorithm (to prevent time-based analysis of MAC digest match)\n\nexports.fixedTimeComparison = function (a, b) {\n\n    if (typeof a !== 'string' ||\n        typeof b !== 'string') {\n\n        return false;\n    }\n\n    var mismatch = (a.length === b.length ? 0 : 1);\n    if (mismatch) {\n        b = a;\n    }\n\n    for (var i = 0, il = a.length; i < il; ++i) {\n        var ac = a.charCodeAt(i);\n        var bc = b.charCodeAt(i);\n        mismatch |= (ac ^ bc);\n    }\n\n    return (mismatch === 0);\n};\n\n\n"]}
{"version":3,"sources":["oauth.js"],"names":[],"mappings":"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","file":"oauth-compiled.js","sourcesContent":["'use strict'\n\nvar url = require('url')\n  , qs = require('qs')\n  , caseless = require('caseless')\n  , uuid = require('uuid')\n  , oauth = require('oauth-sign')\n  , crypto = require('crypto')\n\n\nfunction OAuth (request) {\n  this.request = request\n  this.params = null\n}\n\nOAuth.prototype.buildParams = function (_oauth, uri, method, query, form, qsLib) {\n  var oa = {}\n  for (var i in _oauth) {\n    oa['oauth_' + i] = _oauth[i]\n  }\n  if (!oa.oauth_version) {\n    oa.oauth_version = '1.0'\n  }\n  if (!oa.oauth_timestamp) {\n    oa.oauth_timestamp = Math.floor( Date.now() / 1000 ).toString()\n  }\n  if (!oa.oauth_nonce) {\n    oa.oauth_nonce = uuid().replace(/-/g, '')\n  }\n  if (!oa.oauth_signature_method) {\n    oa.oauth_signature_method = 'HMAC-SHA1'\n  }\n\n  var consumer_secret_or_private_key = oa.oauth_consumer_secret || oa.oauth_private_key\n  delete oa.oauth_consumer_secret\n  delete oa.oauth_private_key\n\n  var token_secret = oa.oauth_token_secret\n  delete oa.oauth_token_secret\n\n  var realm = oa.oauth_realm\n  delete oa.oauth_realm\n  delete oa.oauth_transport_method\n\n  var baseurl = uri.protocol + '//' + uri.host + uri.pathname\n  var params = qsLib.parse([].concat(query, form, qsLib.stringify(oa)).join('&'))\n\n  oa.oauth_signature = oauth.sign(\n    oa.oauth_signature_method,\n    method,\n    baseurl,\n    params,\n    consumer_secret_or_private_key,\n    token_secret)\n\n  if (realm) {\n    oa.realm = realm\n  }\n\n  return oa\n}\n\nOAuth.prototype.buildBodyHash = function(_oauth, body) {\n  if (['HMAC-SHA1', 'RSA-SHA1'].indexOf(_oauth.signature_method || 'HMAC-SHA1') < 0) {\n    this.request.emit('error', new Error('oauth: ' + _oauth.signature_method +\n      ' signature_method not supported with body_hash signing.'))\n  }\n\n  var shasum = crypto.createHash('sha1')\n  shasum.update(body || '')\n  var sha1 = shasum.digest('hex')\n\n  return new Buffer(sha1).toString('base64')\n}\n\nOAuth.prototype.concatParams = function (oa, sep, wrap) {\n  wrap = wrap || ''\n\n  var params = Object.keys(oa).filter(function (i) {\n    return i !== 'realm' && i !== 'oauth_signature'\n  }).sort()\n\n  if (oa.realm) {\n    params.splice(0, 0, 'realm')\n  }\n  params.push('oauth_signature')\n\n  return params.map(function (i) {\n    return i + '=' + wrap + oauth.rfc3986(oa[i]) + wrap\n  }).join(sep)\n}\n\nOAuth.prototype.onRequest = function (_oauth) {\n  var self = this\n  self.params = _oauth\n\n  var uri = self.request.uri || {}\n    , method = self.request.method || ''\n    , headers = caseless(self.request.headers)\n    , body = self.request.body || ''\n    , qsLib = self.request.qsLib || qs\n\n  var form\n    , query\n    , contentType = headers.get('content-type') || ''\n    , formContentType = 'application/x-www-form-urlencoded'\n    , transport = _oauth.transport_method || 'header'\n\n  if (contentType.slice(0, formContentType.length) === formContentType) {\n    contentType = formContentType\n    form = body\n  }\n  if (uri.query) {\n    query = uri.query\n  }\n  if (transport === 'body' && (method !== 'POST' || contentType !== formContentType)) {\n    self.request.emit('error', new Error('oauth: transport_method of body requires POST ' +\n      'and content-type ' + formContentType))\n  }\n\n  if (!form && typeof _oauth.body_hash === 'boolean') {\n    _oauth.body_hash = self.buildBodyHash(_oauth, self.request.body.toString())\n  }\n\n  var oa = self.buildParams(_oauth, uri, method, query, form, qsLib)\n\n  switch (transport) {\n    case 'header':\n      self.request.setHeader('Authorization', 'OAuth ' + self.concatParams(oa, ',', '\"'))\n      break\n\n    case 'query':\n      var href = self.request.uri.href += (query ? '&' : '?') + self.concatParams(oa, '&')\n      self.request.uri = url.parse(href)\n      self.request.path = self.request.uri.path\n      break\n\n    case 'body':\n      self.request.body = (form ? form + '&' : '') + self.concatParams(oa, '&')\n      break\n\n    default:\n      self.request.emit('error', new Error('oauth: transport_method invalid'))\n  }\n}\n\nexports.OAuth = OAuth\n"]}